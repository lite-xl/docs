<!DOCTYPE html><html class=no-js lang=en> <head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="Lightweight and powerful code editor, available for Windows, Linux and macOS." name=description><meta content=Takase name=author><link href=https://takase1121.github.io/lite-xl-docs/user-guide/creating-syntaxes/ rel=canonical><link href=../keymap/ rel=prev><link href=../simple-plugin/ rel=next><link href=../../assets/favicon.png rel=icon><meta content="mkdocs-1.4.2, mkdocs-material-9.0.3" name=generator><title>Creating Syntaxes - Lite XL</title><link href=../../assets/stylesheets/main.6b71719e.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.2505c338.min.css rel=stylesheet><link href=../../stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta content=website property=og:type><meta content="Creating Syntaxes - Lite XL" property=og:title><meta content="Lightweight and powerful code editor, available for Windows, Linux and macOS." property=og:description><meta content=https://takase1121.github.io/lite-xl-docs/assets/images/social/user-guide/creating-syntaxes.png property=og:image><meta content=image/png property=og:image:type><meta content=1200 property=og:image:width><meta content=630 property=og:image:height><meta content=https://takase1121.github.io/lite-xl-docs/user-guide/creating-syntaxes/ property=og:url><meta content=summary_large_image name=twitter:card><meta content="Creating Syntaxes - Lite XL" name=twitter:title><meta content="Lightweight and powerful code editor, available for Windows, Linux and macOS." name=twitter:description><meta content=https://takase1121.github.io/lite-xl-docs/assets/images/social/user-guide/creating-syntaxes.png name=twitter:image><link href=../../assets/stylesheets/custom.min.css rel=stylesheet><script src=../../assets/javascript/custom.min.js></script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body data-md-color-accent data-md-color-primary data-md-color-scheme=default dir=ltr> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox> <input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a class=md-skip href=#syntax-highlighting> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav aria-label=Header class="md-header__inner md-grid"> <a aria-label="Lite XL" class="md-header__button md-logo" data-md-component=logo href=../.. title="Lite XL"> <img alt=logo src=../../assets/icon.svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Lite XL </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Creating Syntaxes </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input aria-label="Switch to dark mode" class=md-option data-md-color-accent data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary data-md-color-scheme=default id=__palette_1 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_2 hidden title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> <input aria-label="Switch to light mode" class=md-option data-md-color-accent data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary data-md-color-scheme=slate id=__palette_2 name=__palette type=radio> <label class="md-header__button md-icon" for=__palette_1 hidden title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false type=text> <label class="md-search__icon md-icon" for=__search> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label=Search class=md-search__options> <button aria-label=Clear class="md-search__icon md-icon" tabindex=-1 title=Clear type=reset> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a class=md-source data-md-component=source href=https://github.com/takase1121/lite-xl-docs/ title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav aria-label=Tabs class=md-tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a class=md-tabs__link href=../..> Home </a> </li> <li class=md-tabs__item> <a href=../../setup/getting-started/ class=md-tabs__link> Set Up </a> </li> <li class=md-tabs__item> <a href=../keymap/ class="md-tabs__link md-tabs__link--active"> User Guide </a> </li> <li class=md-tabs__item> <a href=../../references/contributors/ class=md-tabs__link> References </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label=Navigation class="md-nav md-nav--primary md-nav--lifted" data-md-level=0> <label class=md-nav__title for=__drawer> <a aria-label="Lite XL" class="md-nav__button md-logo" data-md-component=logo href=../.. title="Lite XL"> <img alt=logo src=../../assets/icon.svg> </a> Lite XL </label> <div class=md-nav__source> <a class=md-source data-md-component=source href=https://github.com/takase1121/lite-xl-docs/ title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=../..> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 id=__nav_2 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_2 tabindex=0> Set Up <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="Set Up" class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Set Up </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../setup/getting-started/ class=md-nav__link> Getting Started </a> </li> <li class=md-nav__item> <a href=../../setup/windows/ class=md-nav__link> Windows </a> </li> <li class=md-nav__item> <a href=../../setup/linux/ class=md-nav__link> Linux </a> </li> <li class=md-nav__item> <a href=../../setup/macos/ class=md-nav__link> macOS </a> </li> <li class=md-nav__item> <a href=../../setup/building/ class=md-nav__link> Building </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 id=__nav_3 type=checkbox> <label aria-expanded=true class=md-nav__link for=__nav_3 tabindex=0> User Guide <span class="md-nav__icon md-icon"></span> </label> <nav aria-label="User Guide" class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../keymap/ class=md-nav__link> Keymap </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc> Creating Syntaxes <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Creating Syntaxes </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#how-to-create-syntax-highlighting-plugins-for-lite-xl> How to create syntax highlighting plugins for Lite XL </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#what-syntax-token-types-are-supported> What syntax token types are supported? </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#example-syntax-ssh-config-files> Example syntax: ssh config files </a> <nav aria-label="Example syntax: ssh config files" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#header> Header </a> <nav aria-label=Header class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#files> Files </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#comment> Comment </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#patterns> Patterns </a> <nav aria-label=Patterns class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#simple-pattern> Simple Pattern </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#start-end-pattern> Start &amp; End Pattern </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#start-end-pattern-with-escape> Start &amp; End Pattern with Escape </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#symbols> Symbols </a> <nav aria-label=Symbols class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#tips-double-check-your-patterns> Tips: double-check your patterns! </a> <nav aria-label="Tips: double-check your patterns!" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#case-1-spaces-between-two-symbols-tokens> Case 1: Spaces between two symbols tokens </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#case-2-patterns-symbols-tokens> Case 2: Patterns &amp; symbols tokens </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#testing-your-new-syntax> Testing Your New Syntax </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#example-advanced-syntax-markdown> Example advanced syntax: Markdown </a> <nav aria-label="Example advanced syntax: Markdown" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#syntax-fonts-since-11610> Syntax fonts (Since 1.16.10) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#space-handling-since-v210> Space handling (since v2.1.0) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#simple-patterns-with-multiple-tokens-v11610> Simple patterns with multiple tokens (v1.16.10) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#subsyntaxes-since-v11610> Subsyntaxes (Since v1.16.10) </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../simple-plugin/ class=md-nav__link> Simple Plugin </a> </li> <li class=md-nav__item> <a href=../using-regular-expressions/ class=md-nav__link> Using regular expressions </a> </li> <li class=md-nav__item> <a href=../interacting-with-the-os/ class=md-nav__link> Interacting with the OS </a> </li> <li class=md-nav__item> <a href=../child-processes/ class=md-nav__link> Child processes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 id=__nav_4 type=checkbox> <label aria-expanded=false class=md-nav__link for=__nav_4 tabindex=0> References <span class="md-nav__icon md-icon"></span> </label> <nav aria-label=References class=md-nav data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> References </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../references/contributors/ class=md-nav__link> Contributors </a> </li> <li class=md-nav__item> <a href=../../references/keymap/ class=md-nav__link> Keymap </a> </li> <li class=md-nav__item> <a href=../../references/macos-keymap/ class=md-nav__link> macOS Keymap </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a class=md-nav__link href=#how-to-create-syntax-highlighting-plugins-for-lite-xl> How to create syntax highlighting plugins for Lite XL </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#what-syntax-token-types-are-supported> What syntax token types are supported? </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#example-syntax-ssh-config-files> Example syntax: ssh config files </a> <nav aria-label="Example syntax: ssh config files" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#header> Header </a> <nav aria-label=Header class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#files> Files </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#comment> Comment </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#patterns> Patterns </a> <nav aria-label=Patterns class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#simple-pattern> Simple Pattern </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#start-end-pattern> Start &amp; End Pattern </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#start-end-pattern-with-escape> Start &amp; End Pattern with Escape </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#symbols> Symbols </a> <nav aria-label=Symbols class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#tips-double-check-your-patterns> Tips: double-check your patterns! </a> <nav aria-label="Tips: double-check your patterns!" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#case-1-spaces-between-two-symbols-tokens> Case 1: Spaces between two symbols tokens </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#case-2-patterns-symbols-tokens> Case 2: Patterns &amp; symbols tokens </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a class=md-nav__link href=#testing-your-new-syntax> Testing Your New Syntax </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#example-advanced-syntax-markdown> Example advanced syntax: Markdown </a> <nav aria-label="Example advanced syntax: Markdown" class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a class=md-nav__link href=#syntax-fonts-since-11610> Syntax fonts (Since 1.16.10) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#space-handling-since-v210> Space handling (since v2.1.0) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#simple-patterns-with-multiple-tokens-v11610> Simple patterns with multiple tokens (v1.16.10) </a> </li> <li class=md-nav__item> <a class=md-nav__link href=#subsyntaxes-since-v11610> Subsyntaxes (Since v1.16.10) </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a class="md-content__button md-icon" href=https://github.com/takase1121/lite-xl-docs/edit/master/docs/user-guide/creating-syntaxes.md title="Edit this page"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"></path></svg> </a> <a class="md-content__button md-icon" href=https://github.com/takase1121/lite-xl-docs/raw/master/docs/user-guide/creating-syntaxes.md title="View source of this page"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"></path></svg> </a> <h1 id=syntax-highlighting>Syntax Highlighting</h1> <h2 id=how-to-create-syntax-highlighting-plugins-for-lite-xl>How to create syntax highlighting plugins for Lite XL</h2> <p>Syntax highlighting plugins for Lite XL are Lua files. These define some patterns or regular expressions that match different parts of a given language, assigning token types to each match. These different token types are then given different colors by your chosen color scheme.</p> <p>Like other plugins, syntax definitions are sourced from the following folders, in order:</p> <ul> <li><code>/usr/share/lite-xl/plugins/</code></li> <li><code>$HOME/.config/lite-xl/plugins/</code></li> </ul> <p>NOTE: The exact location of these folders depends on the OS and installation method. For example, on Windows, the variable <code>$USERPROFILE</code> will be used instead of <code>$HOME</code>.</p> <p>The user module folder for Lite XL can generally be found in these places:</p> <ul> <li>Windows: <code>C:\Users\(username)\.config\lite-xl</code></li> <li>macOS: <code>/Users/(usernmame)/.config/lite-xl</code></li> <li>Linux: <code>/home/(username)/.config/lite-xl</code></li> </ul> <p>So, to create a new syntax definition on Linux, you can just create a <code>.lua</code> file in your <code>$HOME/.config/lite-xl/plugins/</code> folder.</p> <h2 id=what-syntax-token-types-are-supported>What syntax token types are supported?</h2> <p>The supported syntax token types, defined by <code>lite-xl/core/style.lua</code>, are:</p> <ul> <li><code>normal</code></li> <li><code>symbol</code></li> <li><code>comment</code></li> <li><code>keyword</code></li> <li><code>keyword2</code></li> <li><code>number</code></li> <li><code>literal</code></li> <li><code>string</code></li> <li><code>operator</code></li> <li><code>function</code></li> </ul> <p>In your syntax highlighting plugin, you write patterns to match parts of the language syntax, assigning these token types to matches. You don't have to use them all - just use as many as you need for your language.</p> <p>Let's walk through an example syntax definition and see how this works.</p> <h2 id=example-syntax-ssh-config-files>Example syntax: ssh config files</h2> <p>This is a small, simple example of a syntax definition. It's intended to highlight SSH Config files and looks like this:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=c1>-- mod-version:2 -- lite-xl 2.0</span>
<a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a><span class=kd>local</span> <span class=n>syntax</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>"core.syntax"</span>
<a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>
<a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=n>syntax</span><span class=p>.</span><span class=n>add</span> <span class=p>{</span>
<a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>  <span class=n>files</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"sshd?/?_?config$"</span> <span class=p>},</span>
<a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>  <span class=n>comment</span> <span class=o>=</span> <span class=s1>'#'</span><span class=p>,</span>
<a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>  <span class=n>patterns</span> <span class=o>=</span> <span class=p>{</span>
<a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"#.*</span><span class=se>\n</span><span class=s2>"</span><span class=p>,</span>        <span class=nb>type</span> <span class=o>=</span> <span class=s2>"comment"</span>  <span class=p>},</span>
<a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"%d+"</span><span class=p>,</span>          <span class=nb>type</span> <span class=o>=</span> <span class=s2>"number"</span>   <span class=p>},</span>
<a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"[%a_][%w_]*"</span><span class=p>,</span>  <span class=nb>type</span> <span class=o>=</span> <span class=s2>"symbol"</span>   <span class=p>},</span>
<a href=#__codelineno-0-11 id=__codelineno-0-11 name=__codelineno-0-11></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"@"</span><span class=p>,</span>            <span class=nb>type</span> <span class=o>=</span> <span class=s2>"operator"</span> <span class=p>},</span>
<a href=#__codelineno-0-12 id=__codelineno-0-12 name=__codelineno-0-12></a>  <span class=p>},</span>
<a href=#__codelineno-0-13 id=__codelineno-0-13 name=__codelineno-0-13></a>  <span class=n>symbols</span> <span class=o>=</span> <span class=p>{</span>
<a href=#__codelineno-0-14 id=__codelineno-0-14 name=__codelineno-0-14></a>    <span class=c1>-- ssh config</span>
<a href=#__codelineno-0-15 id=__codelineno-0-15 name=__codelineno-0-15></a>    <span class=p>[</span><span class=s2>"Host"</span><span class=p>]</span>                         <span class=o>=</span> <span class=s2>"function"</span><span class=p>,</span>
<a href=#__codelineno-0-16 id=__codelineno-0-16 name=__codelineno-0-16></a>    <span class=p>[</span><span class=s2>"ProxyCommand"</span><span class=p>]</span>                 <span class=o>=</span> <span class=s2>"function"</span><span class=p>,</span>
<a href=#__codelineno-0-17 id=__codelineno-0-17 name=__codelineno-0-17></a>
<a href=#__codelineno-0-18 id=__codelineno-0-18 name=__codelineno-0-18></a>    <span class=p>[</span><span class=s2>"HostName"</span><span class=p>]</span>                     <span class=o>=</span> <span class=s2>"keyword"</span><span class=p>,</span>
<a href=#__codelineno-0-19 id=__codelineno-0-19 name=__codelineno-0-19></a>    <span class=p>[</span><span class=s2>"IdentityFile"</span><span class=p>]</span>                 <span class=o>=</span> <span class=s2>"keyword"</span><span class=p>,</span>
<a href=#__codelineno-0-20 id=__codelineno-0-20 name=__codelineno-0-20></a>    <span class=p>...</span>
<a href=#__codelineno-0-21 id=__codelineno-0-21 name=__codelineno-0-21></a>
<a href=#__codelineno-0-22 id=__codelineno-0-22 name=__codelineno-0-22></a>    <span class=c1>-- sshd config</span>
<a href=#__codelineno-0-23 id=__codelineno-0-23 name=__codelineno-0-23></a>    <span class=p>[</span><span class=s2>"Subsystem"</span><span class=p>]</span>                    <span class=o>=</span> <span class=s2>"keyword2"</span><span class=p>,</span>
<a href=#__codelineno-0-24 id=__codelineno-0-24 name=__codelineno-0-24></a>
<a href=#__codelineno-0-25 id=__codelineno-0-25 name=__codelineno-0-25></a>    <span class=c1>-- Literals</span>
<a href=#__codelineno-0-26 id=__codelineno-0-26 name=__codelineno-0-26></a>    <span class=p>[</span><span class=s2>"yes"</span><span class=p>]</span>      <span class=o>=</span> <span class=s2>"literal"</span><span class=p>,</span>
<a href=#__codelineno-0-27 id=__codelineno-0-27 name=__codelineno-0-27></a>    <span class=p>[</span><span class=s2>"no"</span><span class=p>]</span>       <span class=o>=</span> <span class=s2>"literal"</span><span class=p>,</span>
<a href=#__codelineno-0-28 id=__codelineno-0-28 name=__codelineno-0-28></a>    <span class=p>[</span><span class=s2>"any"</span><span class=p>]</span>      <span class=o>=</span> <span class=s2>"literal"</span><span class=p>,</span>
<a href=#__codelineno-0-29 id=__codelineno-0-29 name=__codelineno-0-29></a>    <span class=p>[</span><span class=s2>"ask"</span><span class=p>]</span>      <span class=o>=</span> <span class=s2>"literal"</span><span class=p>,</span>
<a href=#__codelineno-0-30 id=__codelineno-0-30 name=__codelineno-0-30></a>  <span class=p>},</span>
<a href=#__codelineno-0-31 id=__codelineno-0-31 name=__codelineno-0-31></a><span class=p>}</span>
</code></pre></div> <p>Let's take each section in turn and see how it works.</p> <h3 id=header>Header</h3> <p>The first line is a Lua comment and tells Lite XL which version this plugin requires. The second imports the <code>core.syntax</code> module to allow us to declare a new syntax:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a><span class=c1>-- mod-version:2 -- lite-xl 2.0</span>
<a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a><span class=kd>local</span> <span class=n>syntax</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>"core.syntax"</span>
</code></pre></div> <p>We then add a syntax definition to Lite XL with <code>syntax.add {...}</code>. The contents of this definition are covered next.</p> <h4 id=files>Files</h4> <p>The <code>files</code> property tells Lite XL which files this syntax should be used for. This is a Lua pattern that matches against the full path of the current file. For example, to match against Markdown files (<code>.md</code> or a <code>.markdown</code> files), you could do this:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a><span class=n>files</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%.md$"</span><span class=p>,</span> <span class=s2>"%.markdown$"</span> <span class=p>},</span>
</code></pre></div> <p>In our original example, we match against the end of the path rather than the extension, because SSH config files don't have extensions, and we don't want to match all <code>config</code> files. We expect the path for SSH config files to look something like one of these:</p> <ul> <li><code>~/.ssh/config</code></li> <li><code>/etc/ssh/ssh_config</code></li> <li><code>/etc/ssh/sshd_config</code></li> </ul> <p>This pattern matches paths that look like that:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a><span class=n>files</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"sshd?/?_?config$"</span> <span class=p>},</span>
</code></pre></div> <h3 id=comment>Comment</h3> <p>The <code>comment</code> property is used to tell Lite XL what to insert in order to create a comment. It is not a part of syntax definition. You can also use <code>block_comment</code> to tell Lite XL how to create multiline / block comments.</p> <h3 id=patterns>Patterns</h3> <p>A given piece of text can only match one pattern. Once Lite XL decides that a piece of text matches a pattern, it will assign that token type to it and move on. Patterns are tested in the order that they are written in the syntax definition, so the first match will win.</p> <p>Patterns are based on Lua patterns or PCRE (Version 2).</p> <p>You may find detailed information on Lua patterns in the [Lua Reference Manual]. For PCRE, there are various [regex tester websites] that provide documentation.</p> <p>Lua patterns can be used by specifying <code>pattern</code> when defining a pattern, while PCRE can be used by specifying <code>regex</code> when defining a pattern.</p> <p>Each pattern takes one of the following forms:</p> <h4 id=simple-pattern>Simple Pattern</h4> <div class=highlight><pre><span></span><code><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a><span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"#.*</span><span class=se>\n</span><span class=s2>"</span><span class=p>,</span>        <span class=nb>type</span> <span class=o>=</span> <span class=s2>"comment"</span> <span class=p>},</span>
</code></pre></div> <p>When <code>pattern</code> is a string, Lite XL will test the input against the pattern. If the input matches, Lite XL will assign the given token type to the input.</p> <p>In this case, any line starting with <code>#</code> will be assigned the type <code>comment</code>.</p> <h4 id=start-end-pattern>Start &amp; End Pattern</h4> <div class=highlight><pre><span></span><code><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a><span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%["</span><span class=p>,</span> <span class=s2>"%]"</span> <span class=p>},</span> <span class=nb>type</span> <span class=o>=</span> <span class=s2>"keyword"</span> <span class=p>},</span>
</code></pre></div> <p>When <code>pattern</code> is a table with 2 elements, Lite XL will use them to test for the start and the end of a range. Everything between the start and the end will be assigned the given token type.</p> <p>In this case, everything between <code>[</code> and <code>]</code> will be assigned the type <code>keyword</code>.</p> <p>However, it does not account for escape sequences. Inputs such as <code>[\]]</code> will be interpreted wrongly as <code>[\]</code> and <code>]</code>.</p> <h4 id=start-end-pattern-with-escape>Start &amp; End Pattern with Escape</h4> <div class=highlight><pre><span></span><code><a href=#__codelineno-6-1 id=__codelineno-6-1 name=__codelineno-6-1></a><span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s1>'"'</span><span class=p>,</span> <span class=s1>'"'</span><span class=p>,</span> <span class=s1>'</span><span class=se>\\</span><span class=s1>'</span> <span class=p>},</span> <span class=nb>type</span> <span class=o>=</span> <span class=s2>"string"</span> <span class=p>},</span>
</code></pre></div> <p>When <code>pattern</code> is a table with 3 elements, Lite XL will use the first two to test for the start and the end of a range. The last element is used to denote an "escape sequence". If the text matches the 3rd element followed by the 2nd element, it will not be interpreted as the end of a range.</p> <p>In this case, everything between <code>"</code> and <code>"</code> will be assigned the type <code>string</code>. A <code>string</code> can have escape sequences prefixed with <code>\</code>.</p> <p>Given the input <code>"\"Hello John\""</code>, the entire input will be assigned the type <code>string</code>.</p> <h3 id=symbols>Symbols</h3> <blockquote> <p>This is <strong>not related to the <code>symbol</code> token type</strong>.</p> </blockquote> <p>The <code>symbols</code> section allows you to assign token types to particular keywords or strings - usually reserved words in the language you are highlighting. The token type in this section <strong>always take precedence</strong> over token types declared in patterns.</p> <p>For example this highlights <code>Host</code> using the <code>function</code> token type, <code>HostName</code> as a <code>keyword</code>, <code>yes</code>, <code>no</code>, <code>any</code> and <code>ask</code> as a <code>literal</code>:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-7-1 id=__codelineno-7-1 name=__codelineno-7-1></a><span class=p>[</span><span class=s2>"Host"</span><span class=p>]</span>                         <span class=o>=</span> <span class=s2>"function"</span><span class=p>,</span>
<a href=#__codelineno-7-2 id=__codelineno-7-2 name=__codelineno-7-2></a><span class=p>[</span><span class=s2>"HostName"</span><span class=p>]</span>                     <span class=o>=</span> <span class=s2>"keyword"</span><span class=p>,</span>
<a href=#__codelineno-7-3 id=__codelineno-7-3 name=__codelineno-7-3></a>
<a href=#__codelineno-7-4 id=__codelineno-7-4 name=__codelineno-7-4></a><span class=p>[</span><span class=s2>"yes"</span><span class=p>]</span>      <span class=o>=</span> <span class=s2>"literal"</span><span class=p>,</span>
<a href=#__codelineno-7-5 id=__codelineno-7-5 name=__codelineno-7-5></a><span class=p>[</span><span class=s2>"no"</span><span class=p>]</span>       <span class=o>=</span> <span class=s2>"literal"</span><span class=p>,</span>
<a href=#__codelineno-7-6 id=__codelineno-7-6 name=__codelineno-7-6></a><span class=p>[</span><span class=s2>"any"</span><span class=p>]</span>      <span class=o>=</span> <span class=s2>"literal"</span><span class=p>,</span>
<a href=#__codelineno-7-7 id=__codelineno-7-7 name=__codelineno-7-7></a><span class=p>[</span><span class=s2>"ask"</span><span class=p>]</span>      <span class=o>=</span> <span class=s2>"literal"</span><span class=p>,</span>
</code></pre></div> <h4 id=tips-double-check-your-patterns>Tips: double-check your patterns!</h4> <p>There are a few common mistakes that can be made when using the <code>symbols</code> table in conjunction with patterns.</p> <h5 id=case-1-spaces-between-two-symbols-tokens>Case 1: Spaces between two <code>symbols</code> tokens</h5> <p>Let's have an example:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-8-1 id=__codelineno-8-1 name=__codelineno-8-1></a><span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"[%a_][%w_]+%s+()[%a_][%w_]+"</span><span class=p>,</span> <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"keyword2"</span><span class=p>,</span> <span class=s2>"symbol"</span> <span class=p>}</span> <span class=p>}</span>
</code></pre></div> <p>Let's explain the pattern a bit (omitting the empty parentheses):</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-9-1 id=__codelineno-9-1 name=__codelineno-9-1></a>[%a_] = any alphabet and underscore
<a href=#__codelineno-9-2 id=__codelineno-9-2 name=__codelineno-9-2></a>[%w_] = any alphabet, number and underscore
<a href=#__codelineno-9-3 id=__codelineno-9-3 name=__codelineno-9-3></a>%s = any whitespace character
<a href=#__codelineno-9-4 id=__codelineno-9-4 name=__codelineno-9-4></a>
<a href=#__codelineno-9-5 id=__codelineno-9-5 name=__codelineno-9-5></a>WORD =
<a href=#__codelineno-9-6 id=__codelineno-9-6 name=__codelineno-9-6></a>  [%a_] followed by (1 or more [%w_])
<a href=#__codelineno-9-7 id=__codelineno-9-7 name=__codelineno-9-7></a>
<a href=#__codelineno-9-8 id=__codelineno-9-8 name=__codelineno-9-8></a>pattern =
<a href=#__codelineno-9-9 id=__codelineno-9-9 name=__codelineno-9-9></a>  WORD followed by (one or more %s) followed by WORD
</code></pre></div> <p>Afterwards, you add an entry <code>["my"] = "literal"</code> in the <code>symbols</code> table. You test the syntax with <code>my function</code> and found that <code>"my"</code> isn't highlighted as <code>literal</code>. Why did that happen?</p> <p><strong><code>symbols</code> table requires an exact match</strong>. If you look carefully, the empty parentheses (<code>()</code>) is placed <strong>after the space</strong>! This tells Lite XL that <code>WORD followed by (one or more %s)</code> is a token, which will match <code>my</code> (note the space in the match).</p> <p>The fix is to add a <code>normal</code> token for the whitespace between the two tokens:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-10-1 id=__codelineno-10-1 name=__codelineno-10-1></a><span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"[%a_][%w_]+()%s+()[%a_][%w_]+"</span><span class=p>,</span> <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"keyword2"</span><span class=p>,</span> <span class=s2>"normal"</span><span class=p>,</span> <span class=s2>"symbol"</span> <span class=p>}</span> <span class=p>}</span>
</code></pre></div> <h5 id=case-2-patterns-symbols-tokens>Case 2: Patterns &amp; <code>symbols</code> tokens</h5> <p>One might assume that Lite XL magically matches text against the <code>symbols</code> table. This is not the case.</p> <p>In some languages, people may add a generic pattern to delegate the matching to the <code>symbols</code> table.</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-11-1 id=__codelineno-11-1 name=__codelineno-11-1></a><span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"[%a_][%w_]*"</span><span class=p>,</span> <span class=s2>"symbol"</span> <span class=p>}</span>
</code></pre></div> <p>However, the <code>symbols</code> table may look like this:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-12-1 id=__codelineno-12-1 name=__codelineno-12-1></a><span class=n>symbols</span> <span class=o>=</span> <span class=p>{</span>
<a href=#__codelineno-12-2 id=__codelineno-12-2 name=__codelineno-12-2></a>  <span class=p>[</span><span class=s2>"my-symbol"</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"function"</span><span class=p>,</span>
<a href=#__codelineno-12-3 id=__codelineno-12-3 name=__codelineno-12-3></a>  <span class=p>[</span><span class=s2>"..something_else"</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"literal"</span>
<a href=#__codelineno-12-4 id=__codelineno-12-4 name=__codelineno-12-4></a><span class=p>}</span>
</code></pre></div> <p><code>"my-symbol</code> contains a dash (<code>-</code>) and <code>"..something_else"</code> contains 2 dots (<code>.</code>). None of the characters are matched by <code>[%a_][%w_]*</code>!</p> <p><strong>Beware of the text you intend to match in the <code>symbols</code> table.</strong> <strong>If you want to use it, you need to ensure that it matches one of the patterns.</strong></p> <p>The correct patterns are:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-13-1 id=__codelineno-13-1 name=__codelineno-13-1></a><span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"[%a_][%w%-_]*"</span><span class=p>,</span> <span class=s2>"symbol"</span> <span class=p>},</span>
<a href=#__codelineno-13-2 id=__codelineno-13-2 name=__codelineno-13-2></a><span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"%.%.[%a_][%w_]*"</span><span class=p>,</span> <span class=s2>"symbol"</span> <span class=p>},</span>
</code></pre></div> <h2 id=testing-your-new-syntax>Testing Your New Syntax</h2> <p>To test your new syntax highlighting you need to do two things:</p> <ul> <li>Reload the Lite XL core</li> <li>Load a file in your chosen language and see how it looks</li> </ul> <p>To reload the core, you can either restart Lite XL or reload it. To do this, type <code>ctrl+shit+p</code> to open the command palette, then select <code>Core: Restart</code> (or type <code>crr</code> or something similar to match it), then press Enter. You will need to restart the core after any changes you make to the syntax highlighting definition.</p> <h2 id=example-advanced-syntax-markdown>Example advanced syntax: Markdown</h2> <blockquote> <p><strong>Note: This example has features from 2.1. It is not compatible with older versions of Lite XL.</strong></p> </blockquote> <p>Not all languages are as simple as SSH config files. Markup languages like HTML and Markdown are especially hard to parse correctly. Here's the Markdown syntax file in its full glory:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-14-1 id=__codelineno-14-1 name=__codelineno-14-1></a><span class=c1>-- mod-version:3</span>
<a href=#__codelineno-14-2 id=__codelineno-14-2 name=__codelineno-14-2></a><span class=kd>local</span> <span class=n>syntax</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>"core.syntax"</span>
<a href=#__codelineno-14-3 id=__codelineno-14-3 name=__codelineno-14-3></a><span class=kd>local</span> <span class=n>style</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>"core.style"</span>
<a href=#__codelineno-14-4 id=__codelineno-14-4 name=__codelineno-14-4></a><span class=kd>local</span> <span class=n>core</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>"core"</span>
<a href=#__codelineno-14-5 id=__codelineno-14-5 name=__codelineno-14-5></a>
<a href=#__codelineno-14-6 id=__codelineno-14-6 name=__codelineno-14-6></a><span class=kd>local</span> <span class=n>initial_color</span> <span class=o>=</span> <span class=n>style</span><span class=p>.</span><span class=n>syntax</span><span class=p>[</span><span class=s2>"keyword2"</span><span class=p>]</span>
<a href=#__codelineno-14-7 id=__codelineno-14-7 name=__codelineno-14-7></a>
<a href=#__codelineno-14-8 id=__codelineno-14-8 name=__codelineno-14-8></a><span class=c1>-- Add 3 type of font styles for use on markdown files</span>
<a href=#__codelineno-14-9 id=__codelineno-14-9 name=__codelineno-14-9></a><span class=kr>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>attr</span> <span class=kr>in</span> <span class=nb>pairs</span><span class=p>({</span><span class=s2>"bold"</span><span class=p>,</span> <span class=s2>"italic"</span><span class=p>,</span> <span class=s2>"bold_italic"</span><span class=p>})</span> <span class=kr>do</span>
<a href=#__codelineno-14-10 id=__codelineno-14-10 name=__codelineno-14-10></a>  <span class=kd>local</span> <span class=n>attributes</span> <span class=o>=</span> <span class=p>{}</span>
<a href=#__codelineno-14-11 id=__codelineno-14-11 name=__codelineno-14-11></a>  <span class=kr>if</span> <span class=n>attr</span> <span class=o>~=</span> <span class=s2>"bold_italic"</span> <span class=kr>then</span>
<a href=#__codelineno-14-12 id=__codelineno-14-12 name=__codelineno-14-12></a>    <span class=n>attributes</span><span class=p>[</span><span class=n>attr</span><span class=p>]</span> <span class=o>=</span> <span class=kc>true</span>
<a href=#__codelineno-14-13 id=__codelineno-14-13 name=__codelineno-14-13></a>  <span class=kr>else</span>
<a href=#__codelineno-14-14 id=__codelineno-14-14 name=__codelineno-14-14></a>    <span class=n>attributes</span><span class=p>[</span><span class=s2>"bold"</span><span class=p>]</span> <span class=o>=</span> <span class=kc>true</span>
<a href=#__codelineno-14-15 id=__codelineno-14-15 name=__codelineno-14-15></a>    <span class=n>attributes</span><span class=p>[</span><span class=s2>"italic"</span><span class=p>]</span> <span class=o>=</span> <span class=kc>true</span>
<a href=#__codelineno-14-16 id=__codelineno-14-16 name=__codelineno-14-16></a>  <span class=kr>end</span>
<a href=#__codelineno-14-17 id=__codelineno-14-17 name=__codelineno-14-17></a>  <span class=c1>-- no way to copy user custom font with additional attributes :(</span>
<a href=#__codelineno-14-18 id=__codelineno-14-18 name=__codelineno-14-18></a>  <span class=n>style</span><span class=p>.</span><span class=n>syntax_fonts</span><span class=p>[</span><span class=s2>"markdown_"</span><span class=o>..</span><span class=n>attr</span><span class=p>]</span> <span class=o>=</span> <span class=n>renderer</span><span class=p>.</span><span class=n>font</span><span class=p>.</span><span class=nb>load</span><span class=p>(</span>
<a href=#__codelineno-14-19 id=__codelineno-14-19 name=__codelineno-14-19></a>    <span class=n>DATADIR</span> <span class=o>..</span> <span class=s2>"/fonts/JetBrainsMono-Regular.ttf"</span><span class=p>,</span>
<a href=#__codelineno-14-20 id=__codelineno-14-20 name=__codelineno-14-20></a>    <span class=n>style</span><span class=p>.</span><span class=n>code_font</span><span class=p>:</span><span class=n>get_size</span><span class=p>(),</span>
<a href=#__codelineno-14-21 id=__codelineno-14-21 name=__codelineno-14-21></a>    <span class=n>attributes</span>
<a href=#__codelineno-14-22 id=__codelineno-14-22 name=__codelineno-14-22></a>  <span class=p>)</span>
<a href=#__codelineno-14-23 id=__codelineno-14-23 name=__codelineno-14-23></a>  <span class=c1>-- also add a color for it</span>
<a href=#__codelineno-14-24 id=__codelineno-14-24 name=__codelineno-14-24></a>  <span class=n>style</span><span class=p>.</span><span class=n>syntax</span><span class=p>[</span><span class=s2>"markdown_"</span><span class=o>..</span><span class=n>attr</span><span class=p>]</span> <span class=o>=</span> <span class=n>style</span><span class=p>.</span><span class=n>syntax</span><span class=p>[</span><span class=s2>"keyword2"</span><span class=p>]</span>
<a href=#__codelineno-14-25 id=__codelineno-14-25 name=__codelineno-14-25></a><span class=kr>end</span>
<a href=#__codelineno-14-26 id=__codelineno-14-26 name=__codelineno-14-26></a>
<a href=#__codelineno-14-27 id=__codelineno-14-27 name=__codelineno-14-27></a><span class=kd>local</span> <span class=n>in_squares_match</span> <span class=o>=</span> <span class=s2>"^%[%]"</span>
<a href=#__codelineno-14-28 id=__codelineno-14-28 name=__codelineno-14-28></a><span class=kd>local</span> <span class=n>in_parenthesis_match</span> <span class=o>=</span> <span class=s2>"^%(%)"</span>
<a href=#__codelineno-14-29 id=__codelineno-14-29 name=__codelineno-14-29></a>
<a href=#__codelineno-14-30 id=__codelineno-14-30 name=__codelineno-14-30></a><span class=n>syntax</span><span class=p>.</span><span class=n>add</span> <span class=p>{</span>
<a href=#__codelineno-14-31 id=__codelineno-14-31 name=__codelineno-14-31></a>  <span class=n>name</span> <span class=o>=</span> <span class=s2>"Markdown"</span><span class=p>,</span>
<a href=#__codelineno-14-32 id=__codelineno-14-32 name=__codelineno-14-32></a>  <span class=n>files</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%.md$"</span><span class=p>,</span> <span class=s2>"%.markdown$"</span> <span class=p>},</span>
<a href=#__codelineno-14-33 id=__codelineno-14-33 name=__codelineno-14-33></a>  <span class=n>block_comment</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"&lt;!--"</span><span class=p>,</span> <span class=s2>"--&gt;"</span> <span class=p>},</span>
<a href=#__codelineno-14-34 id=__codelineno-14-34 name=__codelineno-14-34></a>  <span class=n>space_handling</span> <span class=o>=</span> <span class=kc>false</span><span class=p>,</span> <span class=c1>-- turn off this feature to handle it our selfs</span>
<a href=#__codelineno-14-35 id=__codelineno-14-35 name=__codelineno-14-35></a>  <span class=n>patterns</span> <span class=o>=</span> <span class=p>{</span>
<a href=#__codelineno-14-36 id=__codelineno-14-36 name=__codelineno-14-36></a>  <span class=c1>---- Place patterns that require spaces at start to optimize matching speed</span>
<a href=#__codelineno-14-37 id=__codelineno-14-37 name=__codelineno-14-37></a>  <span class=c1>---- and apply the %s+ optimization immediately afterwards</span>
<a href=#__codelineno-14-38 id=__codelineno-14-38 name=__codelineno-14-38></a>    <span class=c1>-- bullets</span>
<a href=#__codelineno-14-39 id=__codelineno-14-39 name=__codelineno-14-39></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^%s*%*%s"</span><span class=p>,</span>                 <span class=nb>type</span> <span class=o>=</span> <span class=s2>"number"</span> <span class=p>},</span>
<a href=#__codelineno-14-40 id=__codelineno-14-40 name=__codelineno-14-40></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^%s*%-%s"</span><span class=p>,</span>                 <span class=nb>type</span> <span class=o>=</span> <span class=s2>"number"</span> <span class=p>},</span>
<a href=#__codelineno-14-41 id=__codelineno-14-41 name=__codelineno-14-41></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^%s*%+%s"</span><span class=p>,</span>                 <span class=nb>type</span> <span class=o>=</span> <span class=s2>"number"</span> <span class=p>},</span>
<a href=#__codelineno-14-42 id=__codelineno-14-42 name=__codelineno-14-42></a>    <span class=c1>-- numbered bullet</span>
<a href=#__codelineno-14-43 id=__codelineno-14-43 name=__codelineno-14-43></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^%s*[0-9]+[%.%)]%s"</span><span class=p>,</span>       <span class=nb>type</span> <span class=o>=</span> <span class=s2>"number"</span> <span class=p>},</span>
<a href=#__codelineno-14-44 id=__codelineno-14-44 name=__codelineno-14-44></a>    <span class=c1>-- blockquote</span>
<a href=#__codelineno-14-45 id=__codelineno-14-45 name=__codelineno-14-45></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^%s*&gt;+%s"</span><span class=p>,</span>                 <span class=nb>type</span> <span class=o>=</span> <span class=s2>"string"</span> <span class=p>},</span>
<a href=#__codelineno-14-46 id=__codelineno-14-46 name=__codelineno-14-46></a>    <span class=c1>-- alternative bold italic formats</span>
<a href=#__codelineno-14-47 id=__codelineno-14-47 name=__codelineno-14-47></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%s___"</span><span class=p>,</span> <span class=s2>"___%f[%s]"</span> <span class=p>},</span>   <span class=nb>type</span> <span class=o>=</span> <span class=s2>"markdown_bold_italic"</span> <span class=p>},</span>
<a href=#__codelineno-14-48 id=__codelineno-14-48 name=__codelineno-14-48></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%s__"</span><span class=p>,</span> <span class=s2>"__%f[%s]"</span> <span class=p>},</span>     <span class=nb>type</span> <span class=o>=</span> <span class=s2>"markdown_bold"</span> <span class=p>},</span>
<a href=#__codelineno-14-49 id=__codelineno-14-49 name=__codelineno-14-49></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%s_[%S]"</span><span class=p>,</span> <span class=s2>"_%f[%s]"</span> <span class=p>},</span>   <span class=nb>type</span> <span class=o>=</span> <span class=s2>"markdown_italic"</span> <span class=p>},</span>
<a href=#__codelineno-14-50 id=__codelineno-14-50 name=__codelineno-14-50></a>    <span class=c1>-- reference links</span>
<a href=#__codelineno-14-51 id=__codelineno-14-51 name=__codelineno-14-51></a>    <span class=p>{</span>
<a href=#__codelineno-14-52 id=__codelineno-14-52 name=__codelineno-14-52></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^%s*%[%^()["</span><span class=o>..</span><span class=n>in_squares_match</span><span class=o>..</span><span class=s2>"]+()%]: "</span><span class=p>,</span>
<a href=#__codelineno-14-53 id=__codelineno-14-53 name=__codelineno-14-53></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"number"</span><span class=p>,</span> <span class=s2>"function"</span> <span class=p>}</span>
<a href=#__codelineno-14-54 id=__codelineno-14-54 name=__codelineno-14-54></a>    <span class=p>},</span>
<a href=#__codelineno-14-55 id=__codelineno-14-55 name=__codelineno-14-55></a>    <span class=p>{</span>
<a href=#__codelineno-14-56 id=__codelineno-14-56 name=__codelineno-14-56></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^%s*%[%^?()["</span><span class=o>..</span><span class=n>in_squares_match</span><span class=o>..</span><span class=s2>"]+()%]:%s+.+</span><span class=se>\n</span><span class=s2>"</span><span class=p>,</span>
<a href=#__codelineno-14-57 id=__codelineno-14-57 name=__codelineno-14-57></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"number"</span><span class=p>,</span> <span class=s2>"function"</span> <span class=p>}</span>
<a href=#__codelineno-14-58 id=__codelineno-14-58 name=__codelineno-14-58></a>    <span class=p>},</span>
<a href=#__codelineno-14-59 id=__codelineno-14-59 name=__codelineno-14-59></a>    <span class=c1>-- optimization</span>
<a href=#__codelineno-14-60 id=__codelineno-14-60 name=__codelineno-14-60></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"%s+"</span><span class=p>,</span>                      <span class=nb>type</span> <span class=o>=</span> <span class=s2>"normal"</span> <span class=p>},</span>
<a href=#__codelineno-14-61 id=__codelineno-14-61 name=__codelineno-14-61></a>
<a href=#__codelineno-14-62 id=__codelineno-14-62 name=__codelineno-14-62></a>  <span class=c1>---- HTML rules imported and adapted from language_html</span>
<a href=#__codelineno-14-63 id=__codelineno-14-63 name=__codelineno-14-63></a>  <span class=c1>---- to not conflict with markdown rules</span>
<a href=#__codelineno-14-64 id=__codelineno-14-64 name=__codelineno-14-64></a>    <span class=c1>-- Inline JS and CSS</span>
<a href=#__codelineno-14-65 id=__codelineno-14-65 name=__codelineno-14-65></a>    <span class=p>{</span>
<a href=#__codelineno-14-66 id=__codelineno-14-66 name=__codelineno-14-66></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span>
<a href=#__codelineno-14-67 id=__codelineno-14-67 name=__codelineno-14-67></a>      <span class=s2>"&lt;%s*[sS][cC][rR][iI][pP][tT]%s+[tT][yY][pP][eE]%s*=%s*"</span> <span class=o>..</span>
<a href=#__codelineno-14-68 id=__codelineno-14-68 name=__codelineno-14-68></a>        <span class=s2>"['</span><span class=se>\"</span><span class=s2>]%a+/[jJ][aA][vV][aA][sS][cC][rR][iI][pP][tT]['</span><span class=se>\"</span><span class=s2>]%s*&gt;"</span><span class=p>,</span>
<a href=#__codelineno-14-69 id=__codelineno-14-69 name=__codelineno-14-69></a>      <span class=s2>"&lt;%s*/[sS][cC][rR][iI][pP][tT]&gt;"</span>
<a href=#__codelineno-14-70 id=__codelineno-14-70 name=__codelineno-14-70></a>      <span class=p>},</span>
<a href=#__codelineno-14-71 id=__codelineno-14-71 name=__codelineno-14-71></a>      <span class=n>syntax</span> <span class=o>=</span> <span class=s2>".js"</span><span class=p>,</span>
<a href=#__codelineno-14-72 id=__codelineno-14-72 name=__codelineno-14-72></a>      <span class=nb>type</span> <span class=o>=</span> <span class=s2>"function"</span>
<a href=#__codelineno-14-73 id=__codelineno-14-73 name=__codelineno-14-73></a>    <span class=p>},</span>
<a href=#__codelineno-14-74 id=__codelineno-14-74 name=__codelineno-14-74></a>    <span class=p>{</span>
<a href=#__codelineno-14-75 id=__codelineno-14-75 name=__codelineno-14-75></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span>
<a href=#__codelineno-14-76 id=__codelineno-14-76 name=__codelineno-14-76></a>      <span class=s2>"&lt;%s*[sS][cC][rR][iI][pP][tT]%s*&gt;"</span><span class=p>,</span>
<a href=#__codelineno-14-77 id=__codelineno-14-77 name=__codelineno-14-77></a>      <span class=s2>"&lt;%s*/%s*[sS][cC][rR][iI][pP][tT]&gt;"</span>
<a href=#__codelineno-14-78 id=__codelineno-14-78 name=__codelineno-14-78></a>      <span class=p>},</span>
<a href=#__codelineno-14-79 id=__codelineno-14-79 name=__codelineno-14-79></a>      <span class=n>syntax</span> <span class=o>=</span> <span class=s2>".js"</span><span class=p>,</span>
<a href=#__codelineno-14-80 id=__codelineno-14-80 name=__codelineno-14-80></a>      <span class=nb>type</span> <span class=o>=</span> <span class=s2>"function"</span>
<a href=#__codelineno-14-81 id=__codelineno-14-81 name=__codelineno-14-81></a>    <span class=p>},</span>
<a href=#__codelineno-14-82 id=__codelineno-14-82 name=__codelineno-14-82></a>    <span class=p>{</span>
<a href=#__codelineno-14-83 id=__codelineno-14-83 name=__codelineno-14-83></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span>
<a href=#__codelineno-14-84 id=__codelineno-14-84 name=__codelineno-14-84></a>      <span class=s2>"&lt;%s*[sS][tT][yY][lL][eE][^&gt;]*&gt;"</span><span class=p>,</span>
<a href=#__codelineno-14-85 id=__codelineno-14-85 name=__codelineno-14-85></a>      <span class=s2>"&lt;%s*/%s*[sS][tT][yY][lL][eE]%s*&gt;"</span>
<a href=#__codelineno-14-86 id=__codelineno-14-86 name=__codelineno-14-86></a>      <span class=p>},</span>
<a href=#__codelineno-14-87 id=__codelineno-14-87 name=__codelineno-14-87></a>      <span class=n>syntax</span> <span class=o>=</span> <span class=s2>".css"</span><span class=p>,</span>
<a href=#__codelineno-14-88 id=__codelineno-14-88 name=__codelineno-14-88></a>      <span class=nb>type</span> <span class=o>=</span> <span class=s2>"function"</span>
<a href=#__codelineno-14-89 id=__codelineno-14-89 name=__codelineno-14-89></a>    <span class=p>},</span>
<a href=#__codelineno-14-90 id=__codelineno-14-90 name=__codelineno-14-90></a>    <span class=c1>-- Comments</span>
<a href=#__codelineno-14-91 id=__codelineno-14-91 name=__codelineno-14-91></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"&lt;!%-%-"</span><span class=p>,</span> <span class=s2>"%-%-&gt;"</span> <span class=p>},</span>   <span class=nb>type</span> <span class=o>=</span> <span class=s2>"comment"</span> <span class=p>},</span>
<a href=#__codelineno-14-92 id=__codelineno-14-92 name=__codelineno-14-92></a>    <span class=c1>-- Tags</span>
<a href=#__codelineno-14-93 id=__codelineno-14-93 name=__codelineno-14-93></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"%f[^&lt;]![%a_][%w_]*"</span><span class=p>,</span>    <span class=nb>type</span> <span class=o>=</span> <span class=s2>"keyword2"</span> <span class=p>},</span>
<a href=#__codelineno-14-94 id=__codelineno-14-94 name=__codelineno-14-94></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"%f[^&lt;][%a_][%w_]*"</span><span class=p>,</span>     <span class=nb>type</span> <span class=o>=</span> <span class=s2>"function"</span> <span class=p>},</span>
<a href=#__codelineno-14-95 id=__codelineno-14-95 name=__codelineno-14-95></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"%f[^&lt;]/[%a_][%w_]*"</span><span class=p>,</span>    <span class=nb>type</span> <span class=o>=</span> <span class=s2>"function"</span> <span class=p>},</span>
<a href=#__codelineno-14-96 id=__codelineno-14-96 name=__codelineno-14-96></a>    <span class=c1>-- Attributes</span>
<a href=#__codelineno-14-97 id=__codelineno-14-97 name=__codelineno-14-97></a>    <span class=p>{</span>
<a href=#__codelineno-14-98 id=__codelineno-14-98 name=__codelineno-14-98></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"[a-z%-]+%s*()=%s*()</span><span class=se>\"</span><span class=s2>.-</span><span class=se>\"</span><span class=s2>"</span><span class=p>,</span>
<a href=#__codelineno-14-99 id=__codelineno-14-99 name=__codelineno-14-99></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"keyword"</span><span class=p>,</span> <span class=s2>"operator"</span><span class=p>,</span> <span class=s2>"string"</span> <span class=p>}</span>
<a href=#__codelineno-14-100 id=__codelineno-14-100 name=__codelineno-14-100></a>    <span class=p>},</span>
<a href=#__codelineno-14-101 id=__codelineno-14-101 name=__codelineno-14-101></a>    <span class=p>{</span>
<a href=#__codelineno-14-102 id=__codelineno-14-102 name=__codelineno-14-102></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"[a-z%-]+%s*()=%s*()'.-'"</span><span class=p>,</span>
<a href=#__codelineno-14-103 id=__codelineno-14-103 name=__codelineno-14-103></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"keyword"</span><span class=p>,</span> <span class=s2>"operator"</span><span class=p>,</span> <span class=s2>"string"</span> <span class=p>}</span>
<a href=#__codelineno-14-104 id=__codelineno-14-104 name=__codelineno-14-104></a>    <span class=p>},</span>
<a href=#__codelineno-14-105 id=__codelineno-14-105 name=__codelineno-14-105></a>    <span class=p>{</span>
<a href=#__codelineno-14-106 id=__codelineno-14-106 name=__codelineno-14-106></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"[a-z%-]+%s*()=%s*()%-?%d[%d%.]*"</span><span class=p>,</span>
<a href=#__codelineno-14-107 id=__codelineno-14-107 name=__codelineno-14-107></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"keyword"</span><span class=p>,</span> <span class=s2>"operator"</span><span class=p>,</span> <span class=s2>"number"</span> <span class=p>}</span>
<a href=#__codelineno-14-108 id=__codelineno-14-108 name=__codelineno-14-108></a>    <span class=p>},</span>
<a href=#__codelineno-14-109 id=__codelineno-14-109 name=__codelineno-14-109></a>    <span class=c1>-- Entities</span>
<a href=#__codelineno-14-110 id=__codelineno-14-110 name=__codelineno-14-110></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"&amp;#?[a-zA-Z0-9]+;"</span><span class=p>,</span>         <span class=nb>type</span> <span class=o>=</span> <span class=s2>"keyword2"</span> <span class=p>},</span>
<a href=#__codelineno-14-111 id=__codelineno-14-111 name=__codelineno-14-111></a>
<a href=#__codelineno-14-112 id=__codelineno-14-112 name=__codelineno-14-112></a>  <span class=c1>---- Markdown rules</span>
<a href=#__codelineno-14-113 id=__codelineno-14-113 name=__codelineno-14-113></a>    <span class=c1>-- math</span>
<a href=#__codelineno-14-114 id=__codelineno-14-114 name=__codelineno-14-114></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%$%$"</span><span class=p>,</span> <span class=s2>"%$%$"</span><span class=p>,</span> <span class=s2>"</span><span class=se>\\</span><span class=s2>"</span>  <span class=p>},</span>  <span class=nb>type</span> <span class=o>=</span> <span class=s2>"string"</span><span class=p>,</span> <span class=n>syntax</span> <span class=o>=</span> <span class=s2>".tex"</span><span class=p>},</span>
<a href=#__codelineno-14-115 id=__codelineno-14-115 name=__codelineno-14-115></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%$"</span><span class=p>,</span> <span class=s2>"%$"</span><span class=p>,</span> <span class=s2>"</span><span class=se>\\</span><span class=s2>"</span> <span class=p>},</span>       <span class=nb>type</span> <span class=o>=</span> <span class=s2>"string"</span><span class=p>,</span> <span class=n>syntax</span> <span class=o>=</span> <span class=s2>".tex"</span><span class=p>},</span>
<a href=#__codelineno-14-116 id=__codelineno-14-116 name=__codelineno-14-116></a>    <span class=c1>-- code blocks</span>
<a href=#__codelineno-14-117 id=__codelineno-14-117 name=__codelineno-14-117></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"```c++"</span><span class=p>,</span> <span class=s2>"```"</span> <span class=p>},</span>        <span class=nb>type</span> <span class=o>=</span> <span class=s2>"string"</span><span class=p>,</span> <span class=n>syntax</span> <span class=o>=</span> <span class=s2>".cpp"</span> <span class=p>},</span>
<a href=#__codelineno-14-118 id=__codelineno-14-118 name=__codelineno-14-118></a>    <span class=c1>-- ... there's some other patterns here, but I removed them for brevity</span>
<a href=#__codelineno-14-119 id=__codelineno-14-119 name=__codelineno-14-119></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"```lobster"</span><span class=p>,</span> <span class=s2>"```"</span> <span class=p>},</span>    <span class=nb>type</span> <span class=o>=</span> <span class=s2>"string"</span><span class=p>,</span> <span class=n>syntax</span> <span class=o>=</span> <span class=s2>".lobster"</span> <span class=p>},</span>
<a href=#__codelineno-14-120 id=__codelineno-14-120 name=__codelineno-14-120></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"```"</span><span class=p>,</span> <span class=s2>"```"</span> <span class=p>},</span>           <span class=nb>type</span> <span class=o>=</span> <span class=s2>"string"</span> <span class=p>},</span>
<a href=#__codelineno-14-121 id=__codelineno-14-121 name=__codelineno-14-121></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"``"</span><span class=p>,</span> <span class=s2>"``"</span> <span class=p>},</span>             <span class=nb>type</span> <span class=o>=</span> <span class=s2>"string"</span> <span class=p>},</span>
<a href=#__codelineno-14-122 id=__codelineno-14-122 name=__codelineno-14-122></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%f[</span><span class=se>\\</span><span class=s2>`]%`[%S]"</span><span class=p>,</span> <span class=s2>"`"</span> <span class=p>},</span>   <span class=nb>type</span> <span class=o>=</span> <span class=s2>"string"</span> <span class=p>},</span>
<a href=#__codelineno-14-123 id=__codelineno-14-123 name=__codelineno-14-123></a>    <span class=c1>-- strike</span>
<a href=#__codelineno-14-124 id=__codelineno-14-124 name=__codelineno-14-124></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"~~"</span><span class=p>,</span> <span class=s2>"~~"</span> <span class=p>},</span>             <span class=nb>type</span> <span class=o>=</span> <span class=s2>"keyword2"</span> <span class=p>},</span>
<a href=#__codelineno-14-125 id=__codelineno-14-125 name=__codelineno-14-125></a>    <span class=c1>-- highlight</span>
<a href=#__codelineno-14-126 id=__codelineno-14-126 name=__codelineno-14-126></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"=="</span><span class=p>,</span> <span class=s2>"=="</span> <span class=p>},</span>             <span class=nb>type</span> <span class=o>=</span> <span class=s2>"literal"</span> <span class=p>},</span>
<a href=#__codelineno-14-127 id=__codelineno-14-127 name=__codelineno-14-127></a>    <span class=c1>-- lines</span>
<a href=#__codelineno-14-128 id=__codelineno-14-128 name=__codelineno-14-128></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^%-%-%-+</span><span class=se>\n</span><span class=s2>"</span><span class=p>,</span>               <span class=nb>type</span> <span class=o>=</span> <span class=s2>"comment"</span> <span class=p>},</span>
<a href=#__codelineno-14-129 id=__codelineno-14-129 name=__codelineno-14-129></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^%*%*%*+</span><span class=se>\n</span><span class=s2>"</span><span class=p>,</span>               <span class=nb>type</span> <span class=o>=</span> <span class=s2>"comment"</span> <span class=p>},</span>
<a href=#__codelineno-14-130 id=__codelineno-14-130 name=__codelineno-14-130></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^___+</span><span class=se>\n</span><span class=s2>"</span><span class=p>,</span>                  <span class=nb>type</span> <span class=o>=</span> <span class=s2>"comment"</span> <span class=p>},</span>
<a href=#__codelineno-14-131 id=__codelineno-14-131 name=__codelineno-14-131></a>    <span class=c1>-- bold and italic</span>
<a href=#__codelineno-14-132 id=__codelineno-14-132 name=__codelineno-14-132></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%*%*%*%S"</span><span class=p>,</span> <span class=s2>"%*%*%*"</span> <span class=p>},</span>   <span class=nb>type</span> <span class=o>=</span> <span class=s2>"markdown_bold_italic"</span> <span class=p>},</span>
<a href=#__codelineno-14-133 id=__codelineno-14-133 name=__codelineno-14-133></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%*%*%S"</span><span class=p>,</span> <span class=s2>"%*%*"</span> <span class=p>},</span>       <span class=nb>type</span> <span class=o>=</span> <span class=s2>"markdown_bold"</span> <span class=p>},</span>
<a href=#__codelineno-14-134 id=__codelineno-14-134 name=__codelineno-14-134></a>    <span class=c1>-- handle edge case where asterisk can be at end of line and not close</span>
<a href=#__codelineno-14-135 id=__codelineno-14-135 name=__codelineno-14-135></a>    <span class=p>{</span>
<a href=#__codelineno-14-136 id=__codelineno-14-136 name=__codelineno-14-136></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"%f[</span><span class=se>\\</span><span class=s2>%*]%*[%S]"</span><span class=p>,</span> <span class=s2>"%*%f[^%*]"</span> <span class=p>},</span>
<a href=#__codelineno-14-137 id=__codelineno-14-137 name=__codelineno-14-137></a>      <span class=nb>type</span> <span class=o>=</span> <span class=s2>"markdown_italic"</span>
<a href=#__codelineno-14-138 id=__codelineno-14-138 name=__codelineno-14-138></a>    <span class=p>},</span>
<a href=#__codelineno-14-139 id=__codelineno-14-139 name=__codelineno-14-139></a>    <span class=c1>-- alternative bold italic formats</span>
<a href=#__codelineno-14-140 id=__codelineno-14-140 name=__codelineno-14-140></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^___[%s%p%w]+___%s"</span> <span class=p>,</span>      <span class=nb>type</span> <span class=o>=</span> <span class=s2>"markdown_bold_italic"</span> <span class=p>},</span>
<a href=#__codelineno-14-141 id=__codelineno-14-141 name=__codelineno-14-141></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^__[%s%p%w]+__%s"</span> <span class=p>,</span>        <span class=nb>type</span> <span class=o>=</span> <span class=s2>"markdown_bold"</span> <span class=p>},</span>
<a href=#__codelineno-14-142 id=__codelineno-14-142 name=__codelineno-14-142></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^_[%s%p%w]+_%s"</span> <span class=p>,</span>          <span class=nb>type</span> <span class=o>=</span> <span class=s2>"markdown_italic"</span> <span class=p>},</span>
<a href=#__codelineno-14-143 id=__codelineno-14-143 name=__codelineno-14-143></a>    <span class=c1>-- heading with custom id</span>
<a href=#__codelineno-14-144 id=__codelineno-14-144 name=__codelineno-14-144></a>    <span class=p>{</span>
<a href=#__codelineno-14-145 id=__codelineno-14-145 name=__codelineno-14-145></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^#+%s[%w%s%p]+(){()#[%w%-]+()}"</span><span class=p>,</span>
<a href=#__codelineno-14-146 id=__codelineno-14-146 name=__codelineno-14-146></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"keyword"</span><span class=p>,</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"string"</span><span class=p>,</span> <span class=s2>"function"</span> <span class=p>}</span>
<a href=#__codelineno-14-147 id=__codelineno-14-147 name=__codelineno-14-147></a>    <span class=p>},</span>
<a href=#__codelineno-14-148 id=__codelineno-14-148 name=__codelineno-14-148></a>    <span class=c1>-- headings</span>
<a href=#__codelineno-14-149 id=__codelineno-14-149 name=__codelineno-14-149></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^#+%s.+</span><span class=se>\n</span><span class=s2>"</span><span class=p>,</span>                <span class=nb>type</span> <span class=o>=</span> <span class=s2>"keyword"</span> <span class=p>},</span>
<a href=#__codelineno-14-150 id=__codelineno-14-150 name=__codelineno-14-150></a>    <span class=c1>-- superscript and subscript</span>
<a href=#__codelineno-14-151 id=__codelineno-14-151 name=__codelineno-14-151></a>    <span class=p>{</span>
<a href=#__codelineno-14-152 id=__codelineno-14-152 name=__codelineno-14-152></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"%^()%d+()%^"</span><span class=p>,</span>
<a href=#__codelineno-14-153 id=__codelineno-14-153 name=__codelineno-14-153></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"number"</span><span class=p>,</span> <span class=s2>"function"</span> <span class=p>}</span>
<a href=#__codelineno-14-154 id=__codelineno-14-154 name=__codelineno-14-154></a>    <span class=p>},</span>
<a href=#__codelineno-14-155 id=__codelineno-14-155 name=__codelineno-14-155></a>    <span class=p>{</span>
<a href=#__codelineno-14-156 id=__codelineno-14-156 name=__codelineno-14-156></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"%~()%d+()%~"</span><span class=p>,</span>
<a href=#__codelineno-14-157 id=__codelineno-14-157 name=__codelineno-14-157></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"number"</span><span class=p>,</span> <span class=s2>"function"</span> <span class=p>}</span>
<a href=#__codelineno-14-158 id=__codelineno-14-158 name=__codelineno-14-158></a>    <span class=p>},</span>
<a href=#__codelineno-14-159 id=__codelineno-14-159 name=__codelineno-14-159></a>    <span class=c1>-- definitions</span>
<a href=#__codelineno-14-160 id=__codelineno-14-160 name=__codelineno-14-160></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^:%s.+"</span><span class=p>,</span>                   <span class=nb>type</span> <span class=o>=</span> <span class=s2>"function"</span> <span class=p>},</span>
<a href=#__codelineno-14-161 id=__codelineno-14-161 name=__codelineno-14-161></a>    <span class=c1>-- emoji</span>
<a href=#__codelineno-14-162 id=__codelineno-14-162 name=__codelineno-14-162></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>":[a-zA-Z0-9_%-]+:"</span><span class=p>,</span>        <span class=nb>type</span> <span class=o>=</span> <span class=s2>"literal"</span> <span class=p>},</span>
<a href=#__codelineno-14-163 id=__codelineno-14-163 name=__codelineno-14-163></a>    <span class=c1>-- images and link</span>
<a href=#__codelineno-14-164 id=__codelineno-14-164 name=__codelineno-14-164></a>    <span class=p>{</span>
<a href=#__codelineno-14-165 id=__codelineno-14-165 name=__codelineno-14-165></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"!?%[!?%[()["</span><span class=o>..</span><span class=n>in_squares_match</span><span class=o>..</span><span class=s2>"]+()%]%(()["</span><span class=o>..</span><span class=n>in_parenthesis_match</span><span class=o>..</span><span class=s2>"]+()%)%]%(()["</span><span class=o>..</span><span class=n>in_parenthesis_match</span><span class=o>..</span><span class=s2>"]+()%)"</span><span class=p>,</span>
<a href=#__codelineno-14-166 id=__codelineno-14-166 name=__codelineno-14-166></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"string"</span><span class=p>,</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"number"</span><span class=p>,</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"number"</span><span class=p>,</span> <span class=s2>"function"</span> <span class=p>}</span>
<a href=#__codelineno-14-167 id=__codelineno-14-167 name=__codelineno-14-167></a>    <span class=p>},</span>
<a href=#__codelineno-14-168 id=__codelineno-14-168 name=__codelineno-14-168></a>    <span class=p>{</span>
<a href=#__codelineno-14-169 id=__codelineno-14-169 name=__codelineno-14-169></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"!?%[!?%[?()["</span><span class=o>..</span><span class=n>in_squares_match</span><span class=o>..</span><span class=s2>"]+()%]?%]%(()["</span><span class=o>..</span><span class=n>in_parenthesis_match</span><span class=o>..</span><span class=s2>"]+()%)"</span><span class=p>,</span>
<a href=#__codelineno-14-170 id=__codelineno-14-170 name=__codelineno-14-170></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"string"</span><span class=p>,</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"number"</span><span class=p>,</span> <span class=s2>"function"</span> <span class=p>}</span>
<a href=#__codelineno-14-171 id=__codelineno-14-171 name=__codelineno-14-171></a>    <span class=p>},</span>
<a href=#__codelineno-14-172 id=__codelineno-14-172 name=__codelineno-14-172></a>    <span class=c1>-- reference links</span>
<a href=#__codelineno-14-173 id=__codelineno-14-173 name=__codelineno-14-173></a>    <span class=p>{</span>
<a href=#__codelineno-14-174 id=__codelineno-14-174 name=__codelineno-14-174></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"%[()["</span><span class=o>..</span><span class=n>in_squares_match</span><span class=o>..</span><span class=s2>"]+()%] *()%[()["</span><span class=o>..</span><span class=n>in_squares_match</span><span class=o>..</span><span class=s2>"]+()%]"</span><span class=p>,</span>
<a href=#__codelineno-14-175 id=__codelineno-14-175 name=__codelineno-14-175></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"string"</span><span class=p>,</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"number"</span><span class=p>,</span> <span class=s2>"function"</span> <span class=p>}</span>
<a href=#__codelineno-14-176 id=__codelineno-14-176 name=__codelineno-14-176></a>    <span class=p>},</span>
<a href=#__codelineno-14-177 id=__codelineno-14-177 name=__codelineno-14-177></a>    <span class=p>{</span>
<a href=#__codelineno-14-178 id=__codelineno-14-178 name=__codelineno-14-178></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"!?%[%^?()["</span><span class=o>..</span><span class=n>in_squares_match</span><span class=o>..</span><span class=s2>"]+()%]"</span><span class=p>,</span>
<a href=#__codelineno-14-179 id=__codelineno-14-179 name=__codelineno-14-179></a>      <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"number"</span><span class=p>,</span> <span class=s2>"function"</span> <span class=p>}</span>
<a href=#__codelineno-14-180 id=__codelineno-14-180 name=__codelineno-14-180></a>    <span class=p>},</span>
<a href=#__codelineno-14-181 id=__codelineno-14-181 name=__codelineno-14-181></a>    <span class=c1>-- url's and email</span>
<a href=#__codelineno-14-182 id=__codelineno-14-182 name=__codelineno-14-182></a>    <span class=p>{</span>
<a href=#__codelineno-14-183 id=__codelineno-14-183 name=__codelineno-14-183></a>      <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"&lt;[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+%.[a-zA-Z0-9-.]+&gt;"</span><span class=p>,</span>
<a href=#__codelineno-14-184 id=__codelineno-14-184 name=__codelineno-14-184></a>      <span class=nb>type</span> <span class=o>=</span> <span class=s2>"function"</span>
<a href=#__codelineno-14-185 id=__codelineno-14-185 name=__codelineno-14-185></a>    <span class=p>},</span>
<a href=#__codelineno-14-186 id=__codelineno-14-186 name=__codelineno-14-186></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"&lt;https?://%S+&gt;"</span><span class=p>,</span>           <span class=nb>type</span> <span class=o>=</span> <span class=s2>"function"</span> <span class=p>},</span>
<a href=#__codelineno-14-187 id=__codelineno-14-187 name=__codelineno-14-187></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"https?://%S+"</span><span class=p>,</span>             <span class=nb>type</span> <span class=o>=</span> <span class=s2>"function"</span> <span class=p>},</span>
<a href=#__codelineno-14-188 id=__codelineno-14-188 name=__codelineno-14-188></a>    <span class=c1>-- optimize consecutive dashes used in tables</span>
<a href=#__codelineno-14-189 id=__codelineno-14-189 name=__codelineno-14-189></a>    <span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"%-+"</span><span class=p>,</span>                      <span class=nb>type</span> <span class=o>=</span> <span class=s2>"normal"</span> <span class=p>},</span>
<a href=#__codelineno-14-190 id=__codelineno-14-190 name=__codelineno-14-190></a>  <span class=p>},</span>
<a href=#__codelineno-14-191 id=__codelineno-14-191 name=__codelineno-14-191></a>  <span class=n>symbols</span> <span class=o>=</span> <span class=p>{</span> <span class=p>},</span>
<a href=#__codelineno-14-192 id=__codelineno-14-192 name=__codelineno-14-192></a><span class=p>}</span>
<a href=#__codelineno-14-193 id=__codelineno-14-193 name=__codelineno-14-193></a>
<a href=#__codelineno-14-194 id=__codelineno-14-194 name=__codelineno-14-194></a><span class=c1>-- Adjust the color on theme changes</span>
<a href=#__codelineno-14-195 id=__codelineno-14-195 name=__codelineno-14-195></a><span class=n>core</span><span class=p>.</span><span class=n>add_thread</span><span class=p>(</span><span class=kr>function</span><span class=p>()</span>
<a href=#__codelineno-14-196 id=__codelineno-14-196 name=__codelineno-14-196></a>  <span class=kr>while</span> <span class=kc>true</span> <span class=kr>do</span>
<a href=#__codelineno-14-197 id=__codelineno-14-197 name=__codelineno-14-197></a>    <span class=kr>if</span> <span class=n>initial_color</span> <span class=o>~=</span> <span class=n>style</span><span class=p>.</span><span class=n>syntax</span><span class=p>[</span><span class=s2>"keyword2"</span><span class=p>]</span> <span class=kr>then</span>
<a href=#__codelineno-14-198 id=__codelineno-14-198 name=__codelineno-14-198></a>      <span class=kr>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>attr</span> <span class=kr>in</span> <span class=nb>pairs</span><span class=p>({</span><span class=s2>"bold"</span><span class=p>,</span> <span class=s2>"italic"</span><span class=p>,</span> <span class=s2>"bold_italic"</span><span class=p>})</span> <span class=kr>do</span>
<a href=#__codelineno-14-199 id=__codelineno-14-199 name=__codelineno-14-199></a>        <span class=n>style</span><span class=p>.</span><span class=n>syntax</span><span class=p>[</span><span class=s2>"markdown_"</span><span class=o>..</span><span class=n>attr</span><span class=p>]</span> <span class=o>=</span> <span class=n>style</span><span class=p>.</span><span class=n>syntax</span><span class=p>[</span><span class=s2>"keyword2"</span><span class=p>]</span>
<a href=#__codelineno-14-200 id=__codelineno-14-200 name=__codelineno-14-200></a>      <span class=kr>end</span>
<a href=#__codelineno-14-201 id=__codelineno-14-201 name=__codelineno-14-201></a>      <span class=n>initial_color</span> <span class=o>=</span> <span class=n>style</span><span class=p>.</span><span class=n>syntax</span><span class=p>[</span><span class=s2>"keyword2"</span><span class=p>]</span>
<a href=#__codelineno-14-202 id=__codelineno-14-202 name=__codelineno-14-202></a>    <span class=kr>end</span>
<a href=#__codelineno-14-203 id=__codelineno-14-203 name=__codelineno-14-203></a>    <span class=nb>coroutine.yield</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<a href=#__codelineno-14-204 id=__codelineno-14-204 name=__codelineno-14-204></a>  <span class=kr>end</span>
<a href=#__codelineno-14-205 id=__codelineno-14-205 name=__codelineno-14-205></a><span class=kr>end</span><span class=p>)</span>
</code></pre></div> <p>It demonstrates a lot of syntax highlighting features that were added to v2.1.0 and some workarounds needed.</p> <h3 id=syntax-fonts-since-11610>Syntax fonts (Since 1.16.10)</h3> <p>The syntax allows users to set different font styles (bold, italic, etc.) for different patterns. To change the font style of a token, add a Font to <code>style.syntax_fonts[token_type]</code>.</p> <p>For example: <div class=highlight><pre><span></span><code><a href=#__codelineno-15-1 id=__codelineno-15-1 name=__codelineno-15-1></a>-- will ensure every "fancysyntax_fancy_token" is italic
<a href=#__codelineno-15-2 id=__codelineno-15-2 name=__codelineno-15-2></a>style.syntax_fonts["fancysyntax_fancy_token"] = renderer.font.load("myfont.ttf", 14 * SCALE, { italic = true })
</code></pre></div></p> <p>The markdown example automates this with a for loop.</p> <p>The limitations here are that fonts cannot be copied with different attributes, thus the font path has to be hard-coded. Other than that, abusing <code>style.syntax_fonts</code> may lead to <strong>slow performance</strong> and <strong>high memory consumption</strong>. This is very obvious when the user tries to resize the editor with <code>ctrl-scroll</code> or <code>ctrl+</code> and <code>ctrl-</code>. Please use it in moderation.</p> <h3 id=space-handling-since-v210>Space handling (since v2.1.0)</h3> <p>By default, Lite XL prepends a pattern <code>{ pattern = "%s+", type = "normal" }</code> to the syntax. This improves the performance drastically on lines that starts with whitespace (e.g. heavily indented lines). It works by matching the whitespace before other patterns in order to prevent Lite XL from iterating the entire syntax. However, there may be syntaxes that require matching spaces (e.g. Markdown with indented blocks) so this can be disabled by setting <code>space_handling</code> to <code>false.</code></p> <blockquote> <p>To keep the space handling optimization or to support older versions of Lite XL, <code>{ pattern = "%s+", type = "normal" }</code> can be added after patterns that require space.</p> </blockquote> <h3 id=simple-patterns-with-multiple-tokens-v11610>Simple patterns with multiple tokens (v1.16.10)</h3> <p>This is an excerpt taken from the Markdown plugin:</p> <div class=highlight><pre><span></span><code><a href=#__codelineno-16-1 id=__codelineno-16-1 name=__codelineno-16-1></a><span class=kd>local</span> <span class=n>in_squares_match</span> <span class=o>=</span> <span class=s2>"^%[%]"</span>
<a href=#__codelineno-16-2 id=__codelineno-16-2 name=__codelineno-16-2></a><span class=c1>-- reference links</span>
<a href=#__codelineno-16-3 id=__codelineno-16-3 name=__codelineno-16-3></a><span class=p>{</span>
<a href=#__codelineno-16-4 id=__codelineno-16-4 name=__codelineno-16-4></a>  <span class=n>pattern</span> <span class=o>=</span> <span class=s2>"^%s*%[%^()["</span><span class=o>..</span><span class=n>in_squares_match</span><span class=o>..</span><span class=s2>"]+()%]: "</span><span class=p>,</span>
<a href=#__codelineno-16-5 id=__codelineno-16-5 name=__codelineno-16-5></a>  <span class=nb>type</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"function"</span><span class=p>,</span> <span class=s2>"number"</span><span class=p>,</span> <span class=s2>"function"</span> <span class=p>}</span>
<a href=#__codelineno-16-6 id=__codelineno-16-6 name=__codelineno-16-6></a><span class=p>},</span>
</code></pre></div> <p>Sometimes it makes sense to highlight different parts of a pattern differently. An empty parenthesis (<code>()</code>) in Lua patterns will return the position of the text in the parentheses. This will tell Lite XL when to change the type of token. For instance, <code>^%s*%[%^</code> is <code>"function"</code>, <code>["..in_squares_match.."]+</code> is <code>"number"</code> and <code>%]:</code> is <code>"function"</code>.</p> <h3 id=subsyntaxes-since-v11610>Subsyntaxes (Since v1.16.10)</h3> <p>Lite XL supports embedding another syntax into the existing syntax. This is used to support code blocks inside the Markdown syntax.</p> <p>For example: <div class=highlight><pre><span></span><code><a href=#__codelineno-17-1 id=__codelineno-17-1 name=__codelineno-17-1></a><span class=p>{</span> <span class=n>pattern</span> <span class=o>=</span> <span class=p>{</span> <span class=s2>"```cpp"</span><span class=p>,</span> <span class=s2>"```"</span> <span class=p>},</span>        <span class=nb>type</span> <span class=o>=</span> <span class=s2>"string"</span><span class=p>,</span> <span class=n>syntax</span> <span class=o>=</span> <span class=s2>".cpp"</span> <span class=p>},</span>
</code></pre></div></p> <p>This would highlight <code>```cpp</code> and <code>```</code> with <code>"string"</code> while everything inside them will be highlighted with a syntax that matches <code>".cpp"</code>.</p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 8, 2023</span> </small> </div> </article> </div> </div> <a class="md-top md-icon" data-md-component=top hidden href=#> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </a> </main> <footer class=md-footer> <nav aria-label=Footer class="md-footer__inner md-grid"> <a aria-label="Previous: Keymap" class="md-footer__link md-footer__link--prev" href=../keymap/ rel=prev> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Keymap </div> </div> </a> <a aria-label="Next: Simple Plugin" class="md-footer__link md-footer__link--next" href=../simple-plugin/ rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Simple Plugin </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a> </div> <div class=md-social> <a class=md-social__link href=https://github.com/lite-xl/lite-xl rel=noopener target=_blank title=github.com> <svg viewbox="0 0 496 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </a> <a class=md-social__link href=https://discord.gg/RWzqC3nx7K rel=noopener target=_blank title=discord.gg> <svg viewbox="0 0 640 512" xmlns=http://www.w3.org/2000/svg><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"></path></svg> </a> <a class=md-social__link href=https://matrix.to/#/#lite-xl:matrix.org rel=noopener target=_blank title=matrix.to> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M.632.55v22.9H2.28V24H0V0h2.28v.55zm7.043 7.26v1.157h.033a3.312 3.312 0 0 1 1.117-1.024c.433-.245.936-.365 1.5-.365.54 0 1.033.107 1.481.314.448.208.785.582 1.02 1.108.254-.374.6-.706 1.034-.992.434-.287.95-.43 1.546-.43.453 0 .872.056 1.26.167.388.11.716.286.993.53.276.245.489.559.646.951.152.392.23.863.23 1.417v5.728h-2.349V11.52c0-.286-.01-.559-.032-.812a1.755 1.755 0 0 0-.18-.66 1.106 1.106 0 0 0-.438-.448c-.194-.11-.457-.166-.785-.166-.332 0-.6.064-.803.189a1.38 1.38 0 0 0-.48.499 1.946 1.946 0 0 0-.231.696 5.56 5.56 0 0 0-.06.785v4.768h-2.35v-4.8c0-.254-.004-.503-.018-.752a2.074 2.074 0 0 0-.143-.688 1.052 1.052 0 0 0-.415-.503c-.194-.125-.476-.19-.854-.19-.111 0-.259.024-.439.074-.18.051-.36.143-.53.282a1.637 1.637 0 0 0-.439.595c-.12.259-.18.6-.18 1.02v4.966H5.46V7.81zm15.693 15.64V.55H21.72V0H24v24h-2.28v-.55z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.footer", "navigation.instant", "navigation.tracking", "navigation.top", "navigation.tabs", "content.code.copy", "content.action.view", "content.action.edit", "header.autohide"], "search": "../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.ba449ae6.min.js></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>