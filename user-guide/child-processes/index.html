<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation for Lite XL, a text editor for Windows, Linux and macOS."><meta name=author content=Takase><link href=https://takase1121.github.io/lite-xl-docs/user-guide/child-processes/ rel=canonical><link href=../interacting-with-the-os/ rel=prev><link href=../../references/contributors/ rel=next><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.2"><title>Child processes - Documentation for Lite XL</title><link rel=stylesheet href=../../assets/stylesheets/main.f56500e0.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.2505c338.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="Child processes - Documentation for Lite XL"><meta property=og:description content="Documentation for Lite XL, a text editor for Windows, Linux and macOS."><meta property=og:image content=https://takase1121.github.io/lite-xl-docs/assets/images/social/user-guide/child-processes.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://takase1121.github.io/lite-xl-docs/user-guide/child-processes/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Child processes - Documentation for Lite XL"><meta name=twitter:description content="Documentation for Lite XL, a text editor for Windows, Linux and macOS."><meta name=twitter:image content=https://takase1121.github.io/lite-xl-docs/assets/images/social/user-guide/child-processes.png></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary data-md-color-accent> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#process-api class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Documentation for Lite XL" class="md-header__button md-logo" aria-label="Documentation for Lite XL" data-md-component=logo> <img src=../../assets/icon.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Documentation for Lite XL </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Child processes </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary data-md-color-accent aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/takase1121/lite-xl-docs/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Documentation for Lite XL" class="md-nav__button md-logo" aria-label="Documentation for Lite XL" data-md-component=logo> <img src=../../assets/icon.svg alt=logo> </a> Documentation for Lite XL </label> <div class=md-nav__source> <a href=https://github.com/takase1121/lite-xl-docs/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Set Up <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Set Up" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Set Up </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../setup/getting-started/ class=md-nav__link> Getting Started </a> </li> <li class=md-nav__item> <a href=../../setup/windows/ class=md-nav__link> Windows </a> </li> <li class=md-nav__item> <a href=../../setup/linux/ class=md-nav__link> Linux </a> </li> <li class=md-nav__item> <a href=../../setup/macos/ class=md-nav__link> macOS </a> </li> <li class=md-nav__item> <a href=../../setup/building/ class=md-nav__link> Building </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> User Guide <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="User Guide" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../keymap/ class=md-nav__link> Keymap </a> </li> <li class=md-nav__item> <a href=../creating-syntaxes/ class=md-nav__link> Creating Syntaxes </a> </li> <li class=md-nav__item> <a href=../simple-plugin/ class=md-nav__link> Simple Plugin </a> </li> <li class=md-nav__item> <a href=../using-regular-expressions/ class=md-nav__link> Using regular expressions </a> </li> <li class=md-nav__item> <a href=../interacting-with-the-os/ class=md-nav__link> Interacting with the OS </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Child processes <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Child processes </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#example-reading-a-file-with-cat class=md-nav__link> Example: reading a file with cat </a> </li> <li class=md-nav__item> <a href=#terms class=md-nav__link> Terms </a> </li> <li class=md-nav__item> <a href=#using-the-process-api class=md-nav__link> Using the Process API </a> <nav class=md-nav aria-label="Using the Process API"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples class=md-nav__link> Examples </a> </li> <li class=md-nav__item> <a href=#reading-from-a-child-process class=md-nav__link> Reading from a child process </a> <nav class=md-nav aria-label="Reading from a child process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_1 class=md-nav__link> Examples </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#waiting-for-a-child-process class=md-nav__link> Waiting for a child process </a> <nav class=md-nav aria-label="Waiting for a child process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_2 class=md-nav__link> Examples </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#terminating-a-child-process class=md-nav__link> Terminating a child process </a> <nav class=md-nav aria-label="Terminating a child process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_3 class=md-nav__link> Examples </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#miscellaneous class=md-nav__link> Miscellaneous </a> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> Error handling </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> References <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=References data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> References </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../references/contributors/ class=md-nav__link> Contributors </a> </li> <li class=md-nav__item> <a href=../../references/keymap/ class=md-nav__link> Keymap </a> </li> <li class=md-nav__item> <a href=../../references/macos-keymap/ class=md-nav__link> macOS Keymap </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#example-reading-a-file-with-cat class=md-nav__link> Example: reading a file with cat </a> </li> <li class=md-nav__item> <a href=#terms class=md-nav__link> Terms </a> </li> <li class=md-nav__item> <a href=#using-the-process-api class=md-nav__link> Using the Process API </a> <nav class=md-nav aria-label="Using the Process API"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples class=md-nav__link> Examples </a> </li> <li class=md-nav__item> <a href=#reading-from-a-child-process class=md-nav__link> Reading from a child process </a> <nav class=md-nav aria-label="Reading from a child process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_1 class=md-nav__link> Examples </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#waiting-for-a-child-process class=md-nav__link> Waiting for a child process </a> <nav class=md-nav aria-label="Waiting for a child process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_2 class=md-nav__link> Examples </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#terminating-a-child-process class=md-nav__link> Terminating a child process </a> <nav class=md-nav aria-label="Terminating a child process"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_3 class=md-nav__link> Examples </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#miscellaneous class=md-nav__link> Miscellaneous </a> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> Error handling </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/takase1121/lite-xl-docs/edit/master/docs/user-guide/child-processes.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/takase1121/lite-xl-docs/raw/master/docs/user-guide/child-processes.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <h1 id=process-api>Process API</h1> <p>Lite XL provides a process API to launch external applications. This API is meant to replace Lua's <code>io.popen</code>, <code>system.exec()</code> and lite's <a href=https://github.com/rxi/console/blob/fb3d414d085d4110364314d6cd8380dc1d386249/init.lua#L100>pipe-to-a-file</a> approach.</p> <p>Advantages of this API includes:</p> <ul> <li>Proper argument escaping (arguments are supplied via a table)</li> <li>Non-blocking IO</li> <li>Able to detach processes from Lite XL</li> <li>Does not create temporary files</li> <li>Mostly cross-platform (does not require special code for each shell)</li> <li>Does not create a console window on Windows</li> </ul> <p>Unless you plan to run a command and forget about it, you should stick with the Process API as it provides more features.</p> <h2 id=example-reading-a-file-with-cat>Example: reading a file with <code>cat</code></h2> <p>This example uses <code>cat</code> to read a file. This approach is impractical, but it demonstrates the typical usage of the Process API.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kd>local</span> <span class=n>core</span> <span class=o>=</span> <span class=nb>require</span> <span class=s2>&quot;core&quot;</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kd>local</span> <span class=n>filename</span> <span class=o>=</span> <span class=s2>&quot;myfile.lua&quot;</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=kd>local</span> <span class=n>proc</span> <span class=o>=</span> <span class=n>process</span><span class=p>.</span><span class=n>start</span> <span class=p>{</span> <span class=s2>&quot;cat&quot;</span><span class=p>,</span> <span class=n>filename</span> <span class=p>}</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=c1>-- we use core.add_thread so that we don&#39;t softlock the editor</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1>-- while reading the output of the child process.</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=n>core</span><span class=p>.</span><span class=n>add_thread</span><span class=p>(</span><span class=kr>function</span><span class=p>()</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>  <span class=kd>local</span> <span class=n>readbuf</span> <span class=o>=</span> <span class=p>{}</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>  <span class=kr>while</span> <span class=kc>true</span> <span class=kr>do</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>    <span class=c1>-- yield so that the rest of the editor can carry out its tasks</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>    <span class=c1>-- eg. accepting input, updating the UI</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>    <span class=nb>coroutine.yield</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>    <span class=c1>-- try to read from the standard output of the process.</span>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>    <span class=kd>local</span> <span class=n>read</span> <span class=o>=</span> <span class=n>proc</span><span class=p>:</span><span class=n>read_stdout</span><span class=p>()</span>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>    <span class=c1>-- read == nil is a pretty good indication that the pipe is closed</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>    <span class=c1>-- therefore, no more data can be read.</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>    <span class=kr>if</span> <span class=n>read</span> <span class=o>==</span> <span class=kc>nil</span> <span class=kr>then</span> <span class=kr>break</span> <span class=kr>end</span>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>    <span class=kr>if</span> <span class=n>read</span> <span class=o>~=</span> <span class=s2>&quot;&quot;</span> <span class=kr>then</span>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>      <span class=c1>-- if we read something, append it into the table</span>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>      <span class=n>readbuf</span><span class=p>[</span><span class=o>#</span><span class=n>readbuf</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>read</span>
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>    <span class=kr>end</span>
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>    <span class=c1>-- efficiently concatenate all the output into a string</span>
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>    <span class=kd>local</span> <span class=n>process_output</span> <span class=o>=</span> <span class=nb>table.concat</span><span class=p>(</span><span class=n>readbuf</span><span class=p>)</span>
<a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a>    <span class=c1>-- note: never use core.log(process_output)!</span>
<a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a>    <span class=c1>-- core.log() accepts the same parameters as string.format(),</span>
<a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a>    <span class=c1>-- so you risk injecting invalid format strings!</span>
<a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a>    <span class=n>core</span><span class=p>.</span><span class=n>log</span><span class=p>(</span><span class=s2>&quot;read: %s&quot;</span><span class=p>,</span> <span class=n>process_output</span><span class=p>)</span>
<a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=kr>end</span><span class=p>)</span>
</code></pre></div> <h2 id=terms>Terms</h2> <p>To prevent confusion, these terms are used to describe various things:</p> <table> <thead> <tr> <th>Terms</th> <th>Meaning</th> </tr> </thead> <tbody> <tr> <td>Child process</td> <td>A process created with Process API via <code>process.start()</code></td> </tr> <tr> <td>Parent process</td> <td>The parent process that owns the child. This usually refers to Lite XL.</td> </tr> <tr> <td>Process</td> <td>Any process (including child and parent processes).</td> </tr> <tr> <td>Stream</td> <td>An entity used to transfer data between child and parent processes. Think of it as a queue that can only be enqueued and dequeued.</td> </tr> <tr> <td>Standard input</td> <td>The standard input of most processes. Colloquially known as stdin.</td> </tr> <tr> <td>Standard error</td> <td>The standard error of most processes. Colloquially known as stderr.</td> </tr> <tr> <td>Standard output</td> <td>The standard output of most processes. Colloquially known as stdout.</td> </tr> </tbody> </table> <h2 id=using-the-process-api>Using the Process API</h2> <p>To create a child process, use <code>process.start()</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kr>function</span> <span class=nc>process</span><span class=p>.</span><span class=nf>start</span><span class=p>(</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>  <span class=n>program_args</span><span class=p>:</span> <span class=n>string</span><span class=p>[]</span> <span class=ow>or</span> <span class=n>string</span><span class=p>,</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>  <span class=n>options</span><span class=p>:</span> <span class=p>{</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    <span class=n>timeout</span><span class=p>:</span> <span class=n>number</span><span class=p>,</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    <span class=n>cwd</span><span class=p>:</span> <span class=n>string</span><span class=p>,</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>    <span class=n>stdin</span><span class=p>:</span> <span class=n>process</span><span class=p>.</span><span class=n>redirecttype</span><span class=p>,</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    <span class=n>stdout</span><span class=p>:</span> <span class=n>process</span><span class=p>.</span><span class=n>redirecttype</span><span class=p>,</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>    <span class=n>stderr</span><span class=p>:</span> <span class=n>process</span><span class=p>.</span><span class=n>redirecttype</span><span class=p>,</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=n>env</span><span class=p>:</span> <span class=n>table</span><span class=p>(</span><span class=n>string</span><span class=p>,</span> <span class=n>string</span><span class=p>)</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>  <span class=p>}</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=p>):</span> <span class=n>Process</span>
</code></pre></div> <p>The first argument of the function is a table containing the program name and its arguments. The program name and its arguments need not be escaped as the API does it when necessary.</p> <p>Since v2.1.0, users can provide a string instead of a table as the first argument to prevent the function from escaping them. This may help with legacy software on Windows such as <code>cmd.exe</code>. However, this should not be done on POSIX platforms as the entire string will be treated as the program name and cause issues.</p> <blockquote> <p><strong>Note</strong> Before v2.1.0, this table is not escaped on Windows.</p> </blockquote> <p>The second argument specifies options to control process creation.</p> <p><code>timeout</code> is an advisory value that will be used by <code>process:wait()</code> and is optional.</p> <p><code>cwd</code> is the current working directory of the program. If specified, the child process would run as if it was started in the directory.</p> <p><code>stdin</code>, <code>stdout</code> and <code>stderr</code> tells Lite XL how to treat standard input and output of the child process. There are four possible values:</p> <ul> <li><code>process.REDIRECT_DEFAULT</code> is the default behavior. It will be deprecated in future versions as specifying <code>nil</code> is preferred.</li> <li><code>process.REDIRECT_PIPE</code> allows the Process API to write/read the input/output of the child process.</li> <li><code>process.REDIRECT_PARENT</code> redirects the child process' input/output to the parent. If <code>stdin</code> has this value, child process will accept input from the parent process' console. If <code>stdout</code> or <code>stderr</code> has this value, child process will output to the parent process' console.</li> <li><code>process.REDIRECT_DISCARD</code> discards any data to/from child process.</li> <li><code>process.REDIRECT_STDOUT</code> can only be used on <code>stderr</code> and will redirect the child process' standard error to its standard output.</li> </ul> <p><code>env</code> is a table containing the environment variables for the child process as key-value pairs.</p> <blockquote> <p><strong>Note</strong> On POSIX platforms, this table will <strong>extend</strong> the parent's environment. On Windows, this table will <strong>replace</strong> the parent's environment. In the future, this inconsistency may be fixed.</p> </blockquote> <p>The function returns a <code>Process</code> object that the user should hold onto until the child process can be safely terminated. If the <code>Process</code> object is garbage-collected, the child process will be killed.</p> <h5 id=examples>Examples</h5> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1>-- run something in the background</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=kd>local</span> <span class=n>proc</span> <span class=o>=</span> <span class=n>process</span><span class=p>.</span><span class=n>start</span> <span class=p>{</span> <span class=s2>&quot;bash&quot;</span><span class=p>,</span> <span class=s2>&quot;-c&quot;</span><span class=p>,</span> <span class=s2>&quot;echo hello world&quot;</span> <span class=p>}</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=c1>-- start a process and read its output</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=kd>local</span> <span class=n>proc</span> <span class=o>=</span> <span class=n>process</span><span class=p>.</span><span class=n>start</span><span class=p>({</span> <span class=s2>&quot;cat&quot;</span><span class=p>,</span> <span class=s2>&quot;myfile&quot;</span> <span class=p>},</span> <span class=p>{</span> <span class=n>stdout</span> <span class=o>=</span> <span class=n>process</span><span class=p>.</span><span class=n>REDIRECT_PIPE</span> <span class=p>})</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=c1>-- might or might not print something as the child process</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=c1>-- might not have written data to the standard output</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=nb>print</span><span class=p>(</span><span class=n>proc</span><span class=p>:</span><span class=n>read_stdout</span><span class=p>())</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=c1>-- start a script with verbose output (accepting options over env vars)</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=kd>local</span> <span class=n>proc</span> <span class=o>=</span> <span class=n>process</span><span class=p>.</span><span class=n>start</span><span class=p>({</span> <span class=s2>&quot;./site.rb&quot;</span> <span class=p>},</span> <span class=p>{</span> <span class=n>env</span> <span class=o>=</span> <span class=p>{</span> <span class=n>VERBOSE</span> <span class=o>=</span> <span class=s2>&quot;1&quot;</span> <span class=p>}</span> <span class=p>})</span>
</code></pre></div> <h3 id=reading-from-a-child-process>Reading from a child process</h3> <p>If the child process is created with proper output modes, one can read the standard output/error of the child process with the API.</p> <p>To read from the child process' standard output, use <code>process:read_stdout(len)</code>.</p> <p>To read from the child process' standard error, use <code>process:read_stderr(len)</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kr>function</span> <span class=nc>process</span><span class=p>:</span><span class=nf>read_stdout</span><span class=p>(</span><span class=n>len</span><span class=p>:</span> <span class=n>number</span> <span class=ow>or</span> <span class=kc>nil</span><span class=p>):</span> <span class=n>string</span> <span class=ow>or</span> <span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=n>string</span><span class=p>,</span> <span class=n>number</span><span class=p>)</span> <span class=kr>end</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=kr>function</span> <span class=nc>process</span><span class=p>:</span><span class=nf>read_stdout</span><span class=p>(</span><span class=n>len</span><span class=p>:</span> <span class=n>number</span> <span class=ow>or</span> <span class=kc>nil</span><span class=p>):</span> <span class=n>string</span> <span class=ow>or</span> <span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=n>string</span><span class=p>,</span> <span class=n>number</span><span class=p>)</span> <span class=kr>end</span>
</code></pre></div> <p>The <code>len</code> parameter is optional and is used to specify the maximum number of bytes to read from the stream.</p> <p>These methods return a string with size up to <code>len</code> if data can be read. Otherwise, they will return <code>nil</code>, an error message and the error code.</p> <h5 id=examples_1>Examples</h5> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1>-- proc is a process with stdout set to process.REDIRECT_PIPE</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=c1>-- read default number of bytes (2048) from the process&#39; standard output</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=nb>print</span><span class=p>(</span><span class=n>proc</span><span class=p>:</span><span class=n>read_stdout</span><span class=p>())</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=c1>-- read default number of bytes (2048) from the process&#39; standard error</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=c1>-- ensure that stderr of the process is not set to process.REDIRECT_STDOUT!</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=nb>print</span><span class=p>(</span><span class=n>proc</span><span class=p>:</span><span class=n>read_stderr</span><span class=p>())</span>
</code></pre></div> <h3 id=waiting-for-a-child-process>Waiting for a child process</h3> <p>You might want to wait for a child process to end.</p> <p>To check if a child process is still running, use <code>process:running()</code>.</p> <p>To wait for a child process to end, use <code>process:wait(time)</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=kr>function</span> <span class=nc>process</span><span class=p>:</span><span class=nf>running</span><span class=p>():</span> <span class=n>boolean</span> <span class=kr>end</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=kr>function</span> <span class=nc>process</span><span class=p>:</span><span class=nf>wait</span><span class=p>(</span><span class=n>timeout</span><span class=p>:</span> <span class=n>number</span> <span class=ow>or</span> <span class=kc>nil</span><span class=p>):</span> <span class=n>number</span> <span class=ow>or</span> <span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=n>string</span><span class=p>,</span> <span class=n>number</span><span class=p>)</span> <span class=kr>end</span>
</code></pre></div> <p><code>process:running()</code> returns a boolean immediately indicating whether the process has ended.</p> <blockquote> <p><strong>Note</strong> Do not use <code>process:running()</code> to determine when to stop reading the output of a child process. A child process can end and leave residual data in the stream. Instead, you should call <code>process.read_stdout()</code> or <code>process.read_stderr()</code> until an appropriate error (<code>process.ERROR_PIPE</code>) occurs.</p> </blockquote> <p><code>process:wait(time)</code> will wait for specified number of milliseconds before returning. If the child process has ended, it will return the exit code of the process. If the child process is still running or an error occurred, it will return <code>nil</code> followed by an error message and error code.</p> <p>If <code>time</code> is 0, the method returns immediately. If <code>time</code> is <code>process.WAIT_INFINITE</code>, the method waits until the child process ends. If <code>time</code> is <code>process.WAIT_DEADLINE</code>, the method uses the <code>timeout</code> value specified when calling <code>process.start()</code>. If this value is not specified, it will wait until the child process ends.</p> <h5 id=examples_2>Examples</h5> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1>-- wait for a process to end</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=n>core</span><span class=p>.</span><span class=n>add_thread</span><span class=p>(</span><span class=kr>function</span><span class=p>()</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>  <span class=kr>while</span> <span class=n>process</span><span class=p>:</span><span class=n>running</span><span class=p>()</span> <span class=kr>do</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    <span class=nb>coroutine.yield</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;I am still running&quot;</span><span class=p>)</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>  <span class=kr>end</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>  <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Oh no!&quot;</span><span class=p>)</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=kr>end</span><span class=p>)</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=c1>-- wait for a process to end, and print its exit code.</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;The process exited with the exit code &quot;</span> <span class=o>..</span> <span class=n>process</span><span class=p>:</span><span class=n>wait</span><span class=p>(</span><span class=n>process</span><span class=p>.</span><span class=n>WAIT_INFINITE</span><span class=p>))</span>
</code></pre></div> <h3 id=terminating-a-child-process>Terminating a child process</h3> <p>The Process API allows the user to terminate a child process gracefully or forcefully.</p> <p>Use <code>process:terminate()</code> to terminate a child process gracefully. If it fails, use <code>process:kill()</code> to forcefully terminate it.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kr>function</span> <span class=nc>process</span><span class=p>:</span><span class=nf>terminate</span><span class=p>():</span> <span class=n>boolean</span> <span class=ow>or</span> <span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=n>string</span><span class=p>,</span> <span class=n>number</span><span class=p>)</span> <span class=kr>end</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=kr>function</span> <span class=nc>process</span><span class=p>:</span><span class=nf>kill</span><span class=p>():</span> <span class=n>boolean</span> <span class=ow>or</span> <span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=n>string</span><span class=p>,</span> <span class=n>number</span><span class=p>)</span> <span class=kr>end</span>
</code></pre></div> <p>On POSIX platforms, <code>process:terminate()</code> sends <code>SIGTERM</code> to the child process while <code>process:kill()</code> sends <code>SIGKILL</code> to the child process.</p> <p>On Windows, <code>process:terminate()</code> uses <code>GenerateConsoleCtrlEvent(CTRL_BREAK_EVENT)</code> to simulate CTRL+BREAK. <code>process:kill()</code> uses <code>TerminateProcess()</code> to terminate the process immediately.</p> <blockquote> <p><strong>Note</strong> <code>process:kill()</code> can only <strong>request</strong> a process to be killed. On POSIX, signals are delivered asynchronously; a child process can be too busy to process them (e.g. stuck at a blocking <code>read()</code> or <code>write()</code> call). This is the same on Windows except <code>TerminateProcess()</code> will request cancellation of all pending IO operations. This is impossible on POSIX platforms.</p> </blockquote> <h5 id=examples_3>Examples</h5> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1>-- try to terminate child process</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=n>proc</span><span class=p>:</span><span class=n>terminate</span><span class=p>()</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=c1>-- wait for child process to end</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=kr>if</span> <span class=ow>not</span> <span class=n>proc</span><span class=p>:</span><span class=n>wait</span><span class=p>(</span><span class=mi>1000</span><span class=p>)</span> <span class=kr>then</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>  <span class=c1>-- didn&#39;t work, have to terminate it forcefully</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>  <span class=n>proc</span><span class=p>:</span><span class=n>kill</span><span class=p>()</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=kr>end</span>
</code></pre></div> <h3 id=miscellaneous>Miscellaneous</h3> <p><code>process:pid()</code> can be used to obtain the PID of a child process. It will return <code>0</code> if the process is not running.</p> <p><code>process:returncode()</code> can be used to get the exit code of the child process without calling <code>process:wait()</code>.</p> <p><code>process.strerror()</code> can be used to convert error codes emitted by the process API into human-readable error messages. If an error message is unavailable, <code>nil</code> will be returned.</p> <p><code>process:close_stream()</code> can be used to close the child process' streams.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=kr>function</span> <span class=nc>process</span><span class=p>:</span><span class=nf>pid</span><span class=p>():</span> <span class=n>number</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=kr>function</span> <span class=nc>process</span><span class=p>:</span><span class=nf>returncode</span><span class=p>():</span> <span class=n>number</span> <span class=ow>or</span> <span class=kc>nil</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=kr>function</span> <span class=nc>process</span><span class=p>.</span><span class=nf>strerror</span><span class=p>(</span><span class=n>errcode</span><span class=p>:</span> <span class=n>number</span><span class=p>):</span> <span class=n>string</span> <span class=ow>or</span> <span class=kc>nil</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=kr>function</span> <span class=nc>process</span><span class=p>:</span><span class=nf>close_stream</span><span class=p>(</span><span class=n>stream</span><span class=p>:</span> <span class=n>number</span><span class=p>):</span> <span class=n>number</span> <span class=ow>or</span> <span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=n>string</span><span class=p>,</span> <span class=n>number</span><span class=p>)</span>
</code></pre></div> <blockquote> <p><strong>Note</strong> <code>process:pid()</code> will not return the correct process ID if the child process ended early.</p> </blockquote> <h3 id=error-handling>Error handling</h3> <p>The Process API functions and methods will return error messages/codes or throw errors.</p> <p><code>process.start()</code> will throw an error if the program cannot be run. On Windows, this usually results in an error message <code>"Error creating a process: 2"</code>.</p> <p><code>process:read()</code>, <code>process:read_stdout()</code>, <code>process:read_stderr()</code> and <code>process:write()</code> may throw errors if:</p> <ul> <li>The child process died.</li> <li>The child process closed their side of the input/output.</li> <li>The input/output is closed via <code>process:close_stream()</code>.</li> </ul> <p>Not all errors are documented here. In general, it is recommended to call the functions with <code>pcall()</code> until this inconsistency is fixed in the future.</p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 8, 2023</span> </small> </div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../interacting-with-the-os/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Interacting with the OS" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Interacting with the OS </div> </div> </a> <a href=../../references/contributors/ class="md-footer__link md-footer__link--next" aria-label="Next: Contributors" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Contributors </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.footer", "navigation.instant", "navigation.tracking", "navigation.top", "content.code.copy", "content.action.view", "content.action.edit", "header.autohide"], "search": "../../assets/javascripts/workers/search.12658920.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.5cf534bf.min.js></script> </body> </html>